import{f as Ie,a as q,b as me,t as Dt,c as Ut}from"../chunks/CMwt7tYF.js";import{o as xi,a as kt}from"../chunks/CmM5mwaB.js";import{ad as Co,ah as V,ai as H,aj as Y,af as tt,ag as So,a3 as Re,ae as Lt,f as k,ak as we}from"../chunks/Dxni6C9n.js";import{d as Io,s as Me}from"../chunks/ChfMM_rv.js";import{i as ne}from"../chunks/aGeVYNOu.js";import{s as ke,a as Di,d as Ft,c as Ui,e as ki,b as Li,t as Fi}from"../chunks/Ds127__L.js";import{b as Gi}from"../chunks/CTkgetDu.js";import{w as Vi,a as Qe,g as Gt}from"../chunks/cLnldb3O.js";import{g as Hi,a as bi}from"../chunks/B6JnDhZO.js";import{p as Vt}from"../chunks/DS_W-6P9.js";const gt=Vi(null);function Ze(t){gt.set(t)}function Ht(){gt.set(null)}var qi={};let Bi,Ji;function $i(){return{geminiUrl:Bi,vertexUrl:Ji}}function Yi(t,e,n,o){var s,l;if(!t?.baseUrl){const a=$i();return e?(s=a.vertexUrl)!==null&&s!==void 0?s:n:(l=a.geminiUrl)!==null&&l!==void 0?l:o}return t.baseUrl}class ee{}function _(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(o,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const l=e[s];return l!=null?String(l):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function r(t,e,n){for(let l=0;l<e.length-1;l++){const a=e[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(t[u])){const c=t[u];if(Array.isArray(n))for(let d=0;d<c.length;d++){const f=c[d];r(f,e.slice(l+1),n[d])}else for(const d of c)r(d,e.slice(l+1),n)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in t||(t[u]=[{}]);const c=t[u];r(c[0],e.slice(l+1),n);return}(!t[a]||typeof t[a]!="object")&&(t[a]={}),t=t[a]}const o=e[e.length-1],s=t[o];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[o]=n}function i(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let o=0;o<e.length;o++){if(typeof t!="object"||t===null)return n;const s=e[o];if(s.endsWith("[]")){const l=s.slice(0,-2);if(l in t){const a=t[l];return Array.isArray(a)?a.map(u=>i(u,e.slice(o+1),n)):n}else return n}else t=t[s]}return t}catch(o){if(o instanceof TypeError)return n;throw o}}function Wi(t,e){for(const[n,o]of Object.entries(e)){const s=n.split("."),l=o.split("."),a=new Set;let u=-1;for(let c=0;c<s.length;c++)if(s[c]==="*"){u=c;break}if(u!==-1&&l.length>u)for(let c=u;c<l.length;c++){const d=l[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&a.add(d)}nt(t,s,l,0,a)}}function nt(t,e,n,o,s){if(o>=e.length||typeof t!="object"||t===null)return;const l=e[o];if(l.endsWith("[]")){const a=l.slice(0,-2),u=t;if(a in u&&Array.isArray(u[a]))for(const c of u[a])nt(c,e,n,o+1,s)}else if(l==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const a=t,u=Object.keys(a).filter(d=>!d.startsWith("_")&&!s.has(d)),c={};for(const d of u)c[d]=a[d];for(const[d,f]of Object.entries(c)){const h=[];for(const p of n.slice(o))p==="*"?h.push(d):h.push(p);r(a,h,f)}for(const d of u)delete a[d]}}else{const a=t;l in a&&nt(a[l],e,n,o+1,s)}}function vt(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Ki(t){const e={},n=i(t,["operationName"]);n!=null&&r(e,["operationName"],n);const o=i(t,["resourceName"]);return o!=null&&r(e,["_url","resourceName"],o),e}function zi(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response","generateVideoResponse"]);return a!=null&&r(e,["response"],Xi(a)),e}function Oi(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response"]);return a!=null&&r(e,["response"],Qi(a)),e}function Xi(t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Zi(a))),r(e,["generatedVideos"],l)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function Qi(t){const e={},n=i(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ji(a))),r(e,["generatedVideos"],l)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function Zi(t){const e={},n=i(t,["video"]);return n!=null&&r(e,["video"],ss(n)),e}function ji(t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],rs(n)),e}function es(t){const e={},n=i(t,["operationName"]);return n!=null&&r(e,["_url","operationName"],n),e}function ts(t){const e={},n=i(t,["operationName"]);return n!=null&&r(e,["_url","operationName"],n),e}function ns(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response"]);return a!=null&&r(e,["response"],os(a)),e}function os(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&r(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&r(e,["documentName"],s),e}function Ao(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response"]);return a!=null&&r(e,["response"],is(a)),e}function is(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&r(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&r(e,["documentName"],s),e}function ss(t){const e={},n=i(t,["uri"]);n!=null&&r(e,["uri"],n);const o=i(t,["encodedVideo"]);o!=null&&r(e,["videoBytes"],vt(o));const s=i(t,["encoding"]);return s!=null&&r(e,["mimeType"],s),e}function rs(t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],vt(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}var bt;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(bt||(bt={}));var qt;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(qt||(qt={}));var Bt;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Bt||(Bt={}));var oe;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(oe||(oe={}));var Jt;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Jt||(Jt={}));var $t;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})($t||($t={}));var Yt;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Yt||(Yt={}));var Wt;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Wt||(Wt={}));var Kt;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Kt||(Kt={}));var zt;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(zt||(zt={}));var Ot;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Ot||(Ot={}));var Xt;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(Xt||(Xt={}));var Qt;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Qt||(Qt={}));var Zt;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Zt||(Zt={}));var jt;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(jt||(jt={}));var en;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(en||(en={}));var tn;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(tn||(tn={}));var nn;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(nn||(nn={}));var on;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(on||(on={}));var sn;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(sn||(sn={}));var rn;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(rn||(rn={}));var Se;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Se||(Se={}));var ln;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ln||(ln={}));var an;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(an||(an={}));var un;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(un||(un={}));var ot;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ot||(ot={}));var dn;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(dn||(dn={}));var cn;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(cn||(cn={}));var fn;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(fn||(fn={}));var pn;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pn||(pn={}));var hn;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(hn||(hn={}));var mn;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(mn||(mn={}));var gn;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(gn||(gn={}));var vn;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(vn||(vn={}));var yn;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(yn||(yn={}));var Tn;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Tn||(Tn={}));var _n;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(_n||(_n={}));var En;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(En||(En={}));var Cn;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Cn||(Cn={}));var Sn;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Sn||(Sn={}));var In;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(In||(In={}));var An;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(An||(An={}));var Rn;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(Rn||(Rn={}));var wn;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(wn||(wn={}));var Mn;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(Mn||(Mn={}));var Pn;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Pn||(Pn={}));var Nn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Nn||(Nn={}));var xn;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(xn||(xn={}));var Dn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.ACTIVITY_START="ACTIVITY_START",t.ACTIVITY_END="ACTIVITY_END"})(Dn||(Dn={}));var Un;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Un||(Un={}));var kn;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(kn||(kn={}));var Ln;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Ln||(Ln={}));var Fn;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Fn||(Fn={}));var Gn;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Gn||(Gn={}));var Vn;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Vn||(Vn={}));var ce;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(ce||(ce={}));class it{constructor(e){const n={};for(const o of e.headers.entries())n[o[0]]=o[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class _e{get text(){var e,n,o,s,l,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const h=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,v]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(v!==null||v!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,d+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var e,n,o,s,l,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const h of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&f.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(d+=atob(h.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,o,s,l,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if(d?.length!==0)return d}get executableCode(){var e,n,o,s,l,a,u,c,d;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if(f?.length!==0)return(d=f?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,o,s,l,a,u,c,d;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if(f?.length!==0)return(d=f?.[0])===null||d===void 0?void 0:d.output}}class Hn{}class bn{}class ls{}class as{}class us{}class ds{}class qn{}class Bn{}class Jn{}class cs{}class Ge{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new Ge;let s;const l=e;return n?s=Oi(l):s=zi(l),Object.assign(o,s),o}}class $n{}class Yn{}class Wn{}class Kn{}class fs{}class ps{}class hs{}class yt{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new yt,l=ns(e);return Object.assign(o,l),o}}class ms{}class gs{}class vs{}class zn{}class ys{get text(){var e,n,o;let s="",l=!1;const a=[];for(const u of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,s+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?s:void 0}get data(){var e,n,o;let s="";const l=[];for(const a of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&l.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(s+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class Ts{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Tt{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new Tt,l=Ao(e);return Object.assign(o,l),o}}function N(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Ro(t,e){const n=N(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function wo(t){return Array.isArray(t)?t.map(e=>Ve(e)):[Ve(t)]}function Ve(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Mo(t){const e=Ve(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Po(t){const e=Ve(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function On(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function No(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>On(e)):[On(t)]}function st(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Xn(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Qn(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function G(t){if(t==null)throw new Error("ContentUnion is required");return st(t)?t:{role:"user",parts:No(t)}}function _t(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const o=G(n);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const n=G(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>G(n)):[G(e)]}function W(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Xn(t)||Qn(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[G(t)]}const e=[],n=[],o=st(t[0]);for(const s of t){const l=st(s);if(l!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(s);else{if(Xn(s)||Qn(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return o||e.push({role:"user",parts:No(n)}),e}function _s(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(o=>o!=="null");if(n.length===1)e.type=Object.values(oe).includes(n[0].toUpperCase())?n[0].toUpperCase():oe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of n)e.anyOf.push({type:Object.values(oe).includes(o.toUpperCase())?o.toUpperCase():oe.TYPE_UNSPECIFIED})}}function pe(t){const e={},n=["items"],o=["anyOf"],s=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=t.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,t=l[1]):l[1].type==="null"&&(e.nullable=!0,t=l[0])),t.type instanceof Array&&_s(t.type,e);for(const[a,u]of Object.entries(t))if(u!=null)if(a=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(oe).includes(u.toUpperCase())?u.toUpperCase():oe.TYPE_UNSPECIFIED}else if(n.includes(a))e[a]=pe(u);else if(o.includes(a)){const c=[];for(const d of u){if(d.type=="null"){e.nullable=!0;continue}c.push(pe(d))}e[a]=c}else if(s.includes(a)){const c={};for(const[d,f]of Object.entries(u))c[d]=pe(f);e[a]=c}else{if(a==="additionalProperties")continue;e[a]=u}return e}function Et(t){return pe(t)}function Ct(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function St(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function ge(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=pe(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=pe(e.response));return t}function ve(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Es(t,e,n,o=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function te(t,e){if(typeof e!="string")throw new Error("name must be a string");return Es(t,e,"cachedContents")}function xo(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ie(t){return vt(t)}function Cs(t){return t!=null&&typeof t=="object"&&"name"in t}function Ss(t){return t!=null&&typeof t=="object"&&"video"in t}function Is(t){return t!=null&&typeof t=="object"&&"uri"in t}function Do(t){var e;let n;if(Cs(t)&&(n=t.name),!(Is(t)&&(n=t.uri,n===void 0))&&!(Ss(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Uo(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function ko(t){for(const e of["models","tunedModels","publisherModels"])if(As(t,e))return t[e];return[]}function As(t,e){return t!==null&&typeof t=="object"&&e in t}function Rs(t,e={}){const n=t,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function ws(t,e={}){const n=[],o=new Set;for(const s of t){const l=s.name;if(o.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);o.add(l);const a=Rs(s,e);a.functionDeclarations&&n.push(...a.functionDeclarations)}return{functionDeclarations:n}}function Lo(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const o=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(s>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Ms(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Fo(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const s=n.inlinedResponses;if(!Array.isArray(s)||s.length===0)return t;let l=!1;for(const a of s){if(typeof a!="object"||a===null)continue;const c=a.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function ye(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Go(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function Ps(t){const e={},n=i(t,["responsesFile"]);n!=null&&r(e,["fileName"],n);const o=i(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>ur(a))),r(e,["inlinedResponses"],l)}const s=i(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["inlinedEmbedContentResponses"],l)}return e}function Ns(t){const e={},n=i(t,["predictionsFormat"]);n!=null&&r(e,["format"],n);const o=i(t,["gcsDestination","outputUriPrefix"]);o!=null&&r(e,["gcsUri"],o);const s=i(t,["bigqueryDestination","outputUri"]);return s!=null&&r(e,["bigqueryUri"],s),e}function xs(t){const e={},n=i(t,["format"]);n!=null&&r(e,["predictionsFormat"],n);const o=i(t,["gcsUri"]);o!=null&&r(e,["gcsDestination","outputUriPrefix"],o);const s=i(t,["bigqueryUri"]);if(s!=null&&r(e,["bigqueryDestination","outputUri"],s),i(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(i(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Le(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata","displayName"]);o!=null&&r(e,["displayName"],o);const s=i(t,["metadata","state"]);s!=null&&r(e,["state"],Go(s));const l=i(t,["metadata","createTime"]);l!=null&&r(e,["createTime"],l);const a=i(t,["metadata","endTime"]);a!=null&&r(e,["endTime"],a);const u=i(t,["metadata","updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(t,["metadata","model"]);c!=null&&r(e,["model"],c);const d=i(t,["metadata","output"]);return d!=null&&r(e,["dest"],Ps(Fo(d))),e}function rt(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(t,["state"]);s!=null&&r(e,["state"],Go(s));const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(t,["startTime"]);u!=null&&r(e,["startTime"],u);const c=i(t,["endTime"]);c!=null&&r(e,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(t,["model"]);f!=null&&r(e,["model"],f);const h=i(t,["inputConfig"]);h!=null&&r(e,["src"],Ds(h));const p=i(t,["outputConfig"]);p!=null&&r(e,["dest"],Ns(Fo(p)));const m=i(t,["completionStats"]);return m!=null&&r(e,["completionStats"],m),e}function Ds(t){const e={},n=i(t,["instancesFormat"]);n!=null&&r(e,["format"],n);const o=i(t,["gcsSource","uris"]);o!=null&&r(e,["gcsUri"],o);const s=i(t,["bigquerySource","inputUri"]);return s!=null&&r(e,["bigqueryUri"],s),e}function Us(t,e){const n={};if(i(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(i(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=i(e,["fileName"]);o!=null&&r(n,["fileName"],o);const s=i(e,["inlinedRequests"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>ar(t,a))),r(n,["requests","requests"],l)}return n}function ks(t){const e={},n=i(t,["format"]);n!=null&&r(e,["instancesFormat"],n);const o=i(t,["gcsUri"]);o!=null&&r(e,["gcsSource","uris"],o);const s=i(t,["bigqueryUri"]);if(s!=null&&r(e,["bigquerySource","inputUri"],s),i(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Ls(t){const e={},n=i(t,["data"]);if(n!=null&&r(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Fs(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function Gs(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function Vs(t){const e={},n=i(t,["content"]);n!=null&&r(e,["content"],n);const o=i(t,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],Hs(o));const s=i(t,["tokenCount"]);s!=null&&r(e,["tokenCount"],s);const l=i(t,["finishReason"]);l!=null&&r(e,["finishReason"],l);const a=i(t,["avgLogprobs"]);a!=null&&r(e,["avgLogprobs"],a);const u=i(t,["groundingMetadata"]);u!=null&&r(e,["groundingMetadata"],u);const c=i(t,["index"]);c!=null&&r(e,["index"],c);const d=i(t,["logprobsResult"]);d!=null&&r(e,["logprobsResult"],d);const f=i(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),r(e,["safetyRatings"],p)}const h=i(t,["urlContextMetadata"]);return h!=null&&r(e,["urlContextMetadata"],h),e}function Hs(t){const e={},n=i(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["citations"],o)}return e}function Vo(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>gr(l))),r(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&r(e,["role"],o),e}function bs(t,e){const n={},o=i(t,["displayName"]);if(e!==void 0&&o!=null&&r(e,["batch","displayName"],o),i(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function qs(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(t,["dest"]);return e!==void 0&&s!=null&&r(e,["outputConfig"],xs(Ms(s))),n}function Zn(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["src"]);s!=null&&r(n,["batch","inputConfig"],Us(t,Lo(t,s)));const l=i(e,["config"]);return l!=null&&bs(l,n),n}function Bs(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["model"],N(t,o));const s=i(e,["src"]);s!=null&&r(n,["inputConfig"],ks(Lo(t,s)));const l=i(e,["config"]);return l!=null&&qs(l,n),n}function Js(t,e){const n={},o=i(t,["displayName"]);return e!==void 0&&o!=null&&r(e,["batch","displayName"],o),n}function $s(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["src"]);s!=null&&r(n,["batch","inputConfig"],Qs(t,s));const l=i(e,["config"]);return l!=null&&Js(l,n),n}function Ys(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function Ws(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function Ks(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["name"]);o!=null&&r(e,["name"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);return l!=null&&r(e,["error"],l),e}function zs(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["name"]);o!=null&&r(e,["name"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);return l!=null&&r(e,["error"],l),e}function Os(t,e){const n={},o=i(e,["contents"]);if(o!=null){let l=_t(t,o);Array.isArray(l)&&(l=l.map(a=>a)),r(n,["requests[]","request","content"],l)}const s=i(e,["config"]);return s!=null&&(r(n,["_self"],Xs(s,n)),Wi(n,{"requests[].*":"requests[].request.*"})),n}function Xs(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&r(e,["requests[]","taskType"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&r(e,["requests[]","title"],s);const l=i(t,["outputDimensionality"]);if(e!==void 0&&l!=null&&r(e,["requests[]","outputDimensionality"],l),i(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Qs(t,e){const n={},o=i(e,["fileName"]);o!=null&&r(n,["file_name"],o);const s=i(e,["inlinedRequests"]);return s!=null&&r(n,["requests"],Os(t,s)),n}function Zs(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function js(t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const o=i(t,["args"]);o!=null&&r(e,["args"],o);const s=i(t,["name"]);if(s!=null&&r(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function er(t){const e={},n=i(t,["allowedFunctionNames"]);n!=null&&r(e,["allowedFunctionNames"],n);const o=i(t,["mode"]);if(o!=null&&r(e,["mode"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function tr(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&r(n,["systemInstruction"],Vo(G(s)));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const h=i(e,["responseLogprobs"]);h!=null&&r(o,["responseLogprobs"],h);const p=i(e,["logprobs"]);p!=null&&r(o,["logprobs"],p);const m=i(e,["presencePenalty"]);m!=null&&r(o,["presencePenalty"],m);const v=i(e,["frequencyPenalty"]);v!=null&&r(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const g=i(e,["responseMimeType"]);g!=null&&r(o,["responseMimeType"],g);const T=i(e,["responseSchema"]);T!=null&&r(o,["responseSchema"],Et(T));const C=i(e,["responseJsonSchema"]);if(C!=null&&r(o,["responseJsonSchema"],C),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=i(e,["safetySettings"]);if(n!==void 0&&E!=null){let D=E;Array.isArray(D)&&(D=D.map(J=>vr(J))),r(n,["safetySettings"],D)}const I=i(e,["tools"]);if(n!==void 0&&I!=null){let D=ve(I);Array.isArray(D)&&(D=D.map(J=>Tr(ge(J)))),r(n,["tools"],D)}const S=i(e,["toolConfig"]);if(n!==void 0&&S!=null&&r(n,["toolConfig"],yr(S)),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=i(e,["cachedContent"]);n!==void 0&&R!=null&&r(n,["cachedContent"],te(t,R));const w=i(e,["responseModalities"]);w!=null&&r(o,["responseModalities"],w);const x=i(e,["mediaResolution"]);x!=null&&r(o,["mediaResolution"],x);const A=i(e,["speechConfig"]);if(A!=null&&r(o,["speechConfig"],Ct(A)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=i(e,["thinkingConfig"]);P!=null&&r(o,["thinkingConfig"],P);const U=i(e,["imageConfig"]);U!=null&&r(o,["imageConfig"],lr(U));const Q=i(e,["enableEnhancedCivicAnswers"]);return Q!=null&&r(o,["enableEnhancedCivicAnswers"],Q),o}function nr(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Vs(d))),r(e,["candidates"],c)}const s=i(t,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(t,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(t,["responseId"]);a!=null&&r(e,["responseId"],a);const u=i(t,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function or(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function ir(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],ye(t,o)),n}function sr(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&r(e,["enableWidget"],n),e}function rr(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],n),e}function lr(t){const e={},n=i(t,["aspectRatio"]);n!=null&&r(e,["aspectRatio"],n);const o=i(t,["imageSize"]);if(o!=null&&r(e,["imageSize"],o),i(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(i(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(i(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function ar(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["request","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let u=W(s);Array.isArray(u)&&(u=u.map(c=>Vo(c))),r(n,["request","contents"],u)}const l=i(e,["metadata"]);l!=null&&r(n,["metadata"],l);const a=i(e,["config"]);return a!=null&&r(n,["request","generationConfig"],tr(t,a,i(n,["request"],{}))),n}function ur(t){const e={},n=i(t,["response"]);n!=null&&r(e,["response"],nr(n));const o=i(t,["error"]);return o!=null&&r(e,["error"],o),e}function dr(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);if(e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),i(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function cr(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);e!==void 0&&s!=null&&r(e,["_query","pageToken"],s);const l=i(t,["filter"]);return e!==void 0&&l!=null&&r(e,["_query","filter"],l),n}function fr(t){const e={},n=i(t,["config"]);return n!=null&&dr(n,e),e}function pr(t){const e={},n=i(t,["config"]);return n!=null&&cr(n,e),e}function hr(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["operations"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Le(a))),r(e,["batchJobs"],l)}return e}function mr(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["batchPredictionJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>rt(a))),r(e,["batchJobs"],l)}return e}function gr(t){const e={},n=i(t,["mediaResolution"]);n!=null&&r(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&r(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&r(e,["executableCode"],s);const l=i(t,["fileData"]);l!=null&&r(e,["fileData"],Zs(l));const a=i(t,["functionCall"]);a!=null&&r(e,["functionCall"],js(a));const u=i(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&r(e,["inlineData"],Ls(c));const d=i(t,["text"]);d!=null&&r(e,["text"],d);const f=i(t,["thought"]);f!=null&&r(e,["thought"],f);const h=i(t,["thoughtSignature"]);h!=null&&r(e,["thoughtSignature"],h);const p=i(t,["videoMetadata"]);return p!=null&&r(e,["videoMetadata"],p),e}function vr(t){const e={},n=i(t,["category"]);if(n!=null&&r(e,["category"],n),i(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=i(t,["threshold"]);return o!=null&&r(e,["threshold"],o),e}function yr(t){const e={},n=i(t,["retrievalConfig"]);n!=null&&r(e,["retrievalConfig"],n);const o=i(t,["functionCallingConfig"]);return o!=null&&r(e,["functionCallingConfig"],er(o)),e}function Tr(t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=i(t,["computerUse"]);n!=null&&r(e,["computerUse"],n);const o=i(t,["fileSearch"]);o!=null&&r(e,["fileSearch"],o);const s=i(t,["codeExecution"]);if(s!=null&&r(e,["codeExecution"],s),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=i(t,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>h)),r(e,["functionDeclarations"],f)}const a=i(t,["googleMaps"]);a!=null&&r(e,["googleMaps"],sr(a));const u=i(t,["googleSearch"]);u!=null&&r(e,["googleSearch"],rr(u));const c=i(t,["googleSearchRetrieval"]);c!=null&&r(e,["googleSearchRetrieval"],c);const d=i(t,["urlContext"]);return d!=null&&r(e,["urlContext"],d),e}var j;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(j||(j={}));class re{constructor(e,n,o,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,o,s)}init(e,n,o){var s,l;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n?.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!o||Object.keys(o).length===0?a={config:{}}:typeof o=="object"?a=Object.assign({},o):a=o,a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(s=a.config)===null||s===void 0?void 0:s.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class _r extends ee{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new re(j.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=Zn(this.apiClient,e),o=n._url,s=_("{model}:batchGenerateContent",o),u=n.batch.inputConfig.requests,c=u.requests,d=[];for(const f of c){const h=Object.assign({},f);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}d.push(h)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:s,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const o=n?Object.assign({},n):{},s=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${s}`),o.dest===void 0){const l=this.getGcsUri(e),a=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?o.dest=`${l.slice(0,-6)}/dest`:o.dest=`${l}_dest_${s}`;else if(a)o.dest=`${a}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Bs(this.apiClient,e);return u=_("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>rt(f))}else{const d=Zn(this.apiClient,e);return u=_("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Le(f))}}async createEmbeddingsInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=$s(this.apiClient,e);return l=_("{model}:asyncBatchEmbedContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>Le(c))}}async get(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ir(this.apiClient,e);return u=_("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>rt(f))}else{const d=or(this.apiClient,e);return u=_("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Le(f))}}async cancel(e){var n,o,s,l;let a="",u={};if(this.apiClient.isVertexAI()){const c=Gs(this.apiClient,e);a=_("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const c=Fs(this.apiClient,e);a=_("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=pr(e);return u=_("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=mr(f),p=new zn;return Object.assign(p,h),p})}else{const d=fr(e);return u=_("batches",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=hr(f),p=new zn;return Object.assign(p,h),p})}}async delete(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ws(this.apiClient,e);return u=_("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>zs(f))}else{const d=Ys(this.apiClient,e);return u=_("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>Ks(f))}}}function Er(t){const e={},n=i(t,["data"]);if(n!=null&&r(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function jn(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>$r(l))),r(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&r(e,["role"],o),e}function Cr(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(t,["expireTime"]);e!==void 0&&s!=null&&r(e,["expireTime"],s);const l=i(t,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const a=i(t,["contents"]);if(e!==void 0&&a!=null){let f=W(a);Array.isArray(f)&&(f=f.map(h=>jn(h))),r(e,["contents"],f)}const u=i(t,["systemInstruction"]);e!==void 0&&u!=null&&r(e,["systemInstruction"],jn(G(u)));const c=i(t,["tools"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(h=>Wr(h))),r(e,["tools"],f)}const d=i(t,["toolConfig"]);if(e!==void 0&&d!=null&&r(e,["toolConfig"],Yr(d)),i(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Sr(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(t,["expireTime"]);e!==void 0&&s!=null&&r(e,["expireTime"],s);const l=i(t,["displayName"]);e!==void 0&&l!=null&&r(e,["displayName"],l);const a=i(t,["contents"]);if(e!==void 0&&a!=null){let h=W(a);Array.isArray(h)&&(h=h.map(p=>p)),r(e,["contents"],h)}const u=i(t,["systemInstruction"]);e!==void 0&&u!=null&&r(e,["systemInstruction"],G(u));const c=i(t,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>Kr(p))),r(e,["tools"],h)}const d=i(t,["toolConfig"]);e!==void 0&&d!=null&&r(e,["toolConfig"],d);const f=i(t,["kmsKeyName"]);return e!==void 0&&f!=null&&r(e,["encryption_spec","kmsKeyName"],f),n}function Ir(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["model"],Ro(t,o));const s=i(e,["config"]);return s!=null&&Cr(s,n),n}function Ar(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["model"],Ro(t,o));const s=i(e,["config"]);return s!=null&&Sr(s,n),n}function Rr(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],te(t,o)),n}function wr(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],te(t,o)),n}function Mr(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function Pr(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function Nr(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function xr(t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const o=i(t,["args"]);o!=null&&r(e,["args"],o);const s=i(t,["name"]);if(s!=null&&r(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Dr(t){const e={},n=i(t,["allowedFunctionNames"]);n!=null&&r(e,["allowedFunctionNames"],n);const o=i(t,["mode"]);if(o!=null&&r(e,["mode"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Ur(t){const e={},n=i(t,["description"]);n!=null&&r(e,["description"],n);const o=i(t,["name"]);o!=null&&r(e,["name"],o);const s=i(t,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(t,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(t,["response"]);a!=null&&r(e,["response"],a);const u=i(t,["responseJsonSchema"]);if(u!=null&&r(e,["responseJsonSchema"],u),i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function kr(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],te(t,o)),n}function Lr(t,e){const n={},o=i(e,["name"]);return o!=null&&r(n,["_url","name"],te(t,o)),n}function Fr(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&r(e,["enableWidget"],n),e}function Gr(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],n),e}function Vr(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),n}function Hr(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),n}function br(t){const e={},n=i(t,["config"]);return n!=null&&Vr(n,e),e}function qr(t){const e={},n=i(t,["config"]);return n!=null&&Hr(n,e),e}function Br(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["cachedContents"],l)}return e}function Jr(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["cachedContents"],l)}return e}function $r(t){const e={},n=i(t,["mediaResolution"]);n!=null&&r(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&r(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&r(e,["executableCode"],s);const l=i(t,["fileData"]);l!=null&&r(e,["fileData"],Nr(l));const a=i(t,["functionCall"]);a!=null&&r(e,["functionCall"],xr(a));const u=i(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&r(e,["inlineData"],Er(c));const d=i(t,["text"]);d!=null&&r(e,["text"],d);const f=i(t,["thought"]);f!=null&&r(e,["thought"],f);const h=i(t,["thoughtSignature"]);h!=null&&r(e,["thoughtSignature"],h);const p=i(t,["videoMetadata"]);return p!=null&&r(e,["videoMetadata"],p),e}function Yr(t){const e={},n=i(t,["retrievalConfig"]);n!=null&&r(e,["retrievalConfig"],n);const o=i(t,["functionCallingConfig"]);return o!=null&&r(e,["functionCallingConfig"],Dr(o)),e}function Wr(t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=i(t,["computerUse"]);n!=null&&r(e,["computerUse"],n);const o=i(t,["fileSearch"]);o!=null&&r(e,["fileSearch"],o);const s=i(t,["codeExecution"]);if(s!=null&&r(e,["codeExecution"],s),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=i(t,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>h)),r(e,["functionDeclarations"],f)}const a=i(t,["googleMaps"]);a!=null&&r(e,["googleMaps"],Fr(a));const u=i(t,["googleSearch"]);u!=null&&r(e,["googleSearch"],Gr(u));const c=i(t,["googleSearchRetrieval"]);c!=null&&r(e,["googleSearchRetrieval"],c);const d=i(t,["urlContext"]);return d!=null&&r(e,["urlContext"],d),e}function Kr(t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n);const o=i(t,["computerUse"]);if(o!=null&&r(e,["computerUse"],o),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=i(t,["codeExecution"]);s!=null&&r(e,["codeExecution"],s);const l=i(t,["enterpriseWebSearch"]);l!=null&&r(e,["enterpriseWebSearch"],l);const a=i(t,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>Ur(p))),r(e,["functionDeclarations"],h)}const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(t,["googleSearch"]);c!=null&&r(e,["googleSearch"],c);const d=i(t,["googleSearchRetrieval"]);d!=null&&r(e,["googleSearchRetrieval"],d);const f=i(t,["urlContext"]);return f!=null&&r(e,["urlContext"],f),e}function zr(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(t,["expireTime"]);return e!==void 0&&s!=null&&r(e,["expireTime"],s),n}function Or(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&r(e,["ttl"],o);const s=i(t,["expireTime"]);return e!==void 0&&s!=null&&r(e,["expireTime"],s),n}function Xr(t,e){const n={},o=i(e,["name"]);o!=null&&r(n,["_url","name"],te(t,o));const s=i(e,["config"]);return s!=null&&zr(s,n),n}function Qr(t,e){const n={},o=i(e,["name"]);o!=null&&r(n,["_url","name"],te(t,o));const s=i(e,["config"]);return s!=null&&Or(s,n),n}class Zr extends ee{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new re(j.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(n),n)}async create(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ar(this.apiClient,e);return u=_("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Ir(this.apiClient,e);return u=_("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async get(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Lr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=kr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async delete(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=wr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Pr(f),p=new Wn;return Object.assign(p,h),p})}else{const d=Rr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Mr(f),p=new Wn;return Object.assign(p,h),p})}}async update(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Qr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Xr(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async listInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=qr(e);return u=_("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Jr(f),p=new Kn;return Object.assign(p,h),p})}else{const d=br(e);return u=_("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Br(f),p=new Kn;return Object.assign(p,h),p})}}}function He(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(t);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(t,o[s])&&(n[o[s]]=t[o[s]]);return n}function eo(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(t){return this instanceof M?(this.v=t,this):new M(t)}function z(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(t,e||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(m){return function(v){return Promise.resolve(v).then(m,h)}}function u(m,v){o[m]&&(s[m]=function(y){return new Promise(function(g,T){l.push([m,y,g,T])>1||c(m,y)})},v&&(s[m]=v(s[m])))}function c(m,v){try{d(o[m](v))}catch(y){p(l[0][3],y)}}function d(m){m.value instanceof M?Promise.resolve(m.value.v).then(f,h):p(l[0][2],m)}function f(m){c("next",m)}function h(m){c("throw",m)}function p(m,v){m(v),l.shift(),l.length&&c(l[0][0],l[0][1])}}function O(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof eo=="function"?eo(t):t[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(l){n[l]=t[l]&&function(a){return new Promise(function(u,c){a=t[l](a),s(u,c,a.done,a.value)})}}function s(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}function jr(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Ho(n)}function Ho(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function el(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function to(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let o=0;for(;o<n;)if(t[o].role==="user")e.push(t[o]),o++;else{const s=[];let l=!0;for(;o<n&&t[o].role==="model";)s.push(t[o]),l&&!Ho(t[o])&&(l=!1),o++;l?e.push(...s):e.pop()}return e}class tl{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new nl(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class nl{constructor(e,n,o,s={},l=[]){this.apiClient=e,this.modelsModule=n,this.model=o,this.config=s,this.history=l,this.sendPromise=Promise.resolve(),el(l)}async sendMessage(e){var n;await this.sendPromise;const o=G(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var l,a,u;const c=await s,d=(a=(l=c.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,f=c.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];f!=null&&(p=(u=f.slice(h))!==null&&u!==void 0?u:[]);const m=d?[d]:[];this.recordHistory(o,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var n;await this.sendPromise;const o=G(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const l=await s;return this.processStreamResponse(l,o)}getHistory(e=!1){const n=e?to(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return z(this,arguments,function*(){var s,l,a,u,c,d;const f=[];try{for(var h=!0,p=O(e),m;m=yield M(p.next()),s=m.done,!s;h=!0){u=m.value,h=!1;const v=u;if(jr(v)){const y=(d=(c=v.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content;y!==void 0&&f.push(y)}yield yield M(v)}}catch(v){l={error:v}}finally{try{!h&&!s&&(a=p.return)&&(yield M(a.call(p)))}finally{if(l)throw l.error}}this.recordHistory(n,f)})}recordHistory(e,n,o){let s=[];n.length>0&&n.every(l=>l.role!==void 0)?s=n:s.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...to(o)):this.history.push(e),this.history.push(...s)}}class Be extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Be.prototype)}}function ol(t){const e={},n=i(t,["file"]);return n!=null&&r(e,["file"],n),e}function il(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function sl(t){const e={},n=i(t,["name"]);return n!=null&&r(e,["_url","file"],Do(n)),e}function rl(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function ll(t){const e={},n=i(t,["name"]);return n!=null&&r(e,["_url","file"],Do(n)),e}function al(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),n}function ul(t){const e={},n=i(t,["config"]);return n!=null&&al(n,e),e}function dl(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["files"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["files"],l)}return e}class cl extends ee{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new re(j.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ul(e);return l=_("files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=dl(c),f=new ms;return Object.assign(f,d),f})}}async createInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ol(e);return l=_("upload/v1beta/files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=il(c),f=new gs;return Object.assign(f,d),f})}}async get(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ll(e);return l=_("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=sl(e);return l=_("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=rl(c),f=new vs;return Object.assign(f,d),f})}}}function Fe(t){const e={},n=i(t,["data"]);if(n!=null&&r(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function fl(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ml(l))),r(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&r(e,["role"],o),e}function pl(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function hl(t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const o=i(t,["args"]);o!=null&&r(e,["args"],o);const s=i(t,["name"]);if(s!=null&&r(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ml(t){const e={},n=i(t,["description"]);n!=null&&r(e,["description"],n);const o=i(t,["name"]);o!=null&&r(e,["name"],o);const s=i(t,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(t,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(t,["response"]);a!=null&&r(e,["response"],a);const u=i(t,["responseJsonSchema"]);if(u!=null&&r(e,["responseJsonSchema"],u),i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function gl(t){const e={},n=i(t,["modelSelectionConfig"]);n!=null&&r(e,["modelConfig"],n);const o=i(t,["responseJsonSchema"]);o!=null&&r(e,["responseJsonSchema"],o);const s=i(t,["audioTimestamp"]);s!=null&&r(e,["audioTimestamp"],s);const l=i(t,["candidateCount"]);l!=null&&r(e,["candidateCount"],l);const a=i(t,["enableAffectiveDialog"]);a!=null&&r(e,["enableAffectiveDialog"],a);const u=i(t,["frequencyPenalty"]);u!=null&&r(e,["frequencyPenalty"],u);const c=i(t,["logprobs"]);c!=null&&r(e,["logprobs"],c);const d=i(t,["maxOutputTokens"]);d!=null&&r(e,["maxOutputTokens"],d);const f=i(t,["mediaResolution"]);f!=null&&r(e,["mediaResolution"],f);const h=i(t,["presencePenalty"]);h!=null&&r(e,["presencePenalty"],h);const p=i(t,["responseLogprobs"]);p!=null&&r(e,["responseLogprobs"],p);const m=i(t,["responseMimeType"]);m!=null&&r(e,["responseMimeType"],m);const v=i(t,["responseModalities"]);v!=null&&r(e,["responseModalities"],v);const y=i(t,["responseSchema"]);y!=null&&r(e,["responseSchema"],y);const g=i(t,["routingConfig"]);g!=null&&r(e,["routingConfig"],g);const T=i(t,["seed"]);T!=null&&r(e,["seed"],T);const C=i(t,["speechConfig"]);C!=null&&r(e,["speechConfig"],C);const E=i(t,["stopSequences"]);E!=null&&r(e,["stopSequences"],E);const I=i(t,["temperature"]);I!=null&&r(e,["temperature"],I);const S=i(t,["thinkingConfig"]);S!=null&&r(e,["thinkingConfig"],S);const R=i(t,["topK"]);R!=null&&r(e,["topK"],R);const w=i(t,["topP"]);if(w!=null&&r(e,["topP"],w),i(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function vl(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&r(e,["enableWidget"],n),e}function yl(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],n),e}function Tl(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(t,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(t,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const h=i(t,["speechConfig"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","speechConfig"],St(h));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","thinkingConfig"],p);const m=i(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&r(e,["setup","systemInstruction"],fl(G(v)));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let R=ve(y);Array.isArray(R)&&(R=R.map(w=>Nl(ge(w)))),r(e,["setup","tools"],R)}const g=i(t,["sessionResumption"]);e!==void 0&&g!=null&&r(e,["setup","sessionResumption"],Pl(g));const T=i(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&r(e,["setup","inputAudioTranscription"],T);const C=i(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","outputAudioTranscription"],C);const E=i(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],E);const I=i(t,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const S=i(t,["proactivity"]);if(e!==void 0&&S!=null&&r(e,["setup","proactivity"],S),i(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function _l(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],gl(o));const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(t,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(t,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const h=i(t,["speechConfig"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","speechConfig"],St(h));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","thinkingConfig"],p);const m=i(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&r(e,["setup","systemInstruction"],G(v));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let w=ve(y);Array.isArray(w)&&(w=w.map(x=>xl(ge(x)))),r(e,["setup","tools"],w)}const g=i(t,["sessionResumption"]);e!==void 0&&g!=null&&r(e,["setup","sessionResumption"],g);const T=i(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&r(e,["setup","inputAudioTranscription"],T);const C=i(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","outputAudioTranscription"],C);const E=i(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],E);const I=i(t,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const S=i(t,["proactivity"]);e!==void 0&&S!=null&&r(e,["setup","proactivity"],S);const R=i(t,["explicitVadSignal"]);return e!==void 0&&R!=null&&r(e,["setup","explicitVadSignal"],R),n}function El(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["setup","model"],N(t,o));const s=i(e,["config"]);return s!=null&&r(n,["config"],Tl(s,n)),n}function Cl(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["setup","model"],N(t,o));const s=i(e,["config"]);return s!=null&&r(n,["config"],_l(s,n)),n}function Sl(t){const e={},n=i(t,["musicGenerationConfig"]);return n!=null&&r(e,["musicGenerationConfig"],n),e}function Il(t){const e={},n=i(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["weightedPrompts"],o)}return e}function Al(t){const e={},n=i(t,["media"]);if(n!=null){let d=wo(n);Array.isArray(d)&&(d=d.map(f=>Fe(f))),r(e,["mediaChunks"],d)}const o=i(t,["audio"]);o!=null&&r(e,["audio"],Fe(Po(o)));const s=i(t,["audioStreamEnd"]);s!=null&&r(e,["audioStreamEnd"],s);const l=i(t,["video"]);l!=null&&r(e,["video"],Fe(Mo(l)));const a=i(t,["text"]);a!=null&&r(e,["text"],a);const u=i(t,["activityStart"]);u!=null&&r(e,["activityStart"],u);const c=i(t,["activityEnd"]);return c!=null&&r(e,["activityEnd"],c),e}function Rl(t){const e={},n=i(t,["media"]);if(n!=null){let d=wo(n);Array.isArray(d)&&(d=d.map(f=>f)),r(e,["mediaChunks"],d)}const o=i(t,["audio"]);o!=null&&r(e,["audio"],Po(o));const s=i(t,["audioStreamEnd"]);s!=null&&r(e,["audioStreamEnd"],s);const l=i(t,["video"]);l!=null&&r(e,["video"],Mo(l));const a=i(t,["text"]);a!=null&&r(e,["text"],a);const u=i(t,["activityStart"]);u!=null&&r(e,["activityStart"],u);const c=i(t,["activityEnd"]);return c!=null&&r(e,["activityEnd"],c),e}function wl(t){const e={},n=i(t,["setupComplete"]);n!=null&&r(e,["setupComplete"],n);const o=i(t,["serverContent"]);o!=null&&r(e,["serverContent"],o);const s=i(t,["toolCall"]);s!=null&&r(e,["toolCall"],s);const l=i(t,["toolCallCancellation"]);l!=null&&r(e,["toolCallCancellation"],l);const a=i(t,["usageMetadata"]);a!=null&&r(e,["usageMetadata"],Dl(a));const u=i(t,["goAway"]);u!=null&&r(e,["goAway"],u);const c=i(t,["sessionResumptionUpdate"]);c!=null&&r(e,["sessionResumptionUpdate"],c);const d=i(t,["voiceActivityDetectionSignal"]);d!=null&&r(e,["voiceActivityDetectionSignal"],d);const f=i(t,["voiceActivity"]);return f!=null&&r(e,["voiceActivity"],Ul(f)),e}function Ml(t){const e={},n=i(t,["mediaResolution"]);n!=null&&r(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&r(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&r(e,["executableCode"],s);const l=i(t,["fileData"]);l!=null&&r(e,["fileData"],pl(l));const a=i(t,["functionCall"]);a!=null&&r(e,["functionCall"],hl(a));const u=i(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&r(e,["inlineData"],Fe(c));const d=i(t,["text"]);d!=null&&r(e,["text"],d);const f=i(t,["thought"]);f!=null&&r(e,["thought"],f);const h=i(t,["thoughtSignature"]);h!=null&&r(e,["thoughtSignature"],h);const p=i(t,["videoMetadata"]);return p!=null&&r(e,["videoMetadata"],p),e}function Pl(t){const e={},n=i(t,["handle"]);if(n!=null&&r(e,["handle"],n),i(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Nl(t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=i(t,["computerUse"]);n!=null&&r(e,["computerUse"],n);const o=i(t,["fileSearch"]);o!=null&&r(e,["fileSearch"],o);const s=i(t,["codeExecution"]);if(s!=null&&r(e,["codeExecution"],s),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=i(t,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>h)),r(e,["functionDeclarations"],f)}const a=i(t,["googleMaps"]);a!=null&&r(e,["googleMaps"],vl(a));const u=i(t,["googleSearch"]);u!=null&&r(e,["googleSearch"],yl(u));const c=i(t,["googleSearchRetrieval"]);c!=null&&r(e,["googleSearchRetrieval"],c);const d=i(t,["urlContext"]);return d!=null&&r(e,["urlContext"],d),e}function xl(t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n);const o=i(t,["computerUse"]);if(o!=null&&r(e,["computerUse"],o),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=i(t,["codeExecution"]);s!=null&&r(e,["codeExecution"],s);const l=i(t,["enterpriseWebSearch"]);l!=null&&r(e,["enterpriseWebSearch"],l);const a=i(t,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>ml(p))),r(e,["functionDeclarations"],h)}const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(t,["googleSearch"]);c!=null&&r(e,["googleSearch"],c);const d=i(t,["googleSearchRetrieval"]);d!=null&&r(e,["googleSearchRetrieval"],d);const f=i(t,["urlContext"]);return f!=null&&r(e,["urlContext"],f),e}function Dl(t){const e={},n=i(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const o=i(t,["cachedContentTokenCount"]);o!=null&&r(e,["cachedContentTokenCount"],o);const s=i(t,["candidatesTokenCount"]);s!=null&&r(e,["responseTokenCount"],s);const l=i(t,["toolUsePromptTokenCount"]);l!=null&&r(e,["toolUsePromptTokenCount"],l);const a=i(t,["thoughtsTokenCount"]);a!=null&&r(e,["thoughtsTokenCount"],a);const u=i(t,["totalTokenCount"]);u!=null&&r(e,["totalTokenCount"],u);const c=i(t,["promptTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(v=>v)),r(e,["promptTokensDetails"],m)}const d=i(t,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>v)),r(e,["cacheTokensDetails"],m)}const f=i(t,["candidatesTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(v=>v)),r(e,["responseTokensDetails"],m)}const h=i(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(v=>v)),r(e,["toolUsePromptTokensDetails"],m)}const p=i(t,["trafficType"]);return p!=null&&r(e,["trafficType"],p),e}function Ul(t){const e={},n=i(t,["type"]);return n!=null&&r(e,["voiceActivityType"],n),e}function kl(t){const e={},n=i(t,["data"]);if(n!=null&&r(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function Ll(t){const e={},n=i(t,["content"]);n!=null&&r(e,["content"],n);const o=i(t,["citationMetadata"]);o!=null&&r(e,["citationMetadata"],Fl(o));const s=i(t,["tokenCount"]);s!=null&&r(e,["tokenCount"],s);const l=i(t,["finishReason"]);l!=null&&r(e,["finishReason"],l);const a=i(t,["avgLogprobs"]);a!=null&&r(e,["avgLogprobs"],a);const u=i(t,["groundingMetadata"]);u!=null&&r(e,["groundingMetadata"],u);const c=i(t,["index"]);c!=null&&r(e,["index"],c);const d=i(t,["logprobsResult"]);d!=null&&r(e,["logprobsResult"],d);const f=i(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(m=>m)),r(e,["safetyRatings"],p)}const h=i(t,["urlContextMetadata"]);return h!=null&&r(e,["urlContextMetadata"],h),e}function Fl(t){const e={},n=i(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),r(e,["citations"],o)}return e}function Gl(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let l=W(s);Array.isArray(l)&&(l=l.map(a=>a)),r(n,["contents"],l)}return n}function Vl(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["tokensInfo"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),r(e,["tokensInfo"],s)}return e}function Hl(t){const e={},n=i(t,["values"]);n!=null&&r(e,["values"],n);const o=i(t,["statistics"]);return o!=null&&r(e,["statistics"],bl(o)),e}function bl(t){const e={},n=i(t,["truncated"]);n!=null&&r(e,["truncated"],n);const o=i(t,["token_count"]);return o!=null&&r(e,["tokenCount"],o),e}function Je(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Oa(l))),r(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&r(e,["role"],o),e}function ql(t){const e={},n=i(t,["controlType"]);n!=null&&r(e,["controlType"],n);const o=i(t,["enableControlImageComputation"]);return o!=null&&r(e,["computeControl"],o),e}function Bl(t){const e={};if(i(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(i(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(i(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Jl(t,e){const n={},o=i(t,["systemInstruction"]);e!==void 0&&o!=null&&r(e,["systemInstruction"],G(o));const s=i(t,["tools"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(u=>Jo(u))),r(e,["tools"],a)}const l=i(t,["generationConfig"]);return e!==void 0&&l!=null&&r(e,["generationConfig"],ka(l)),n}function $l(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let a=W(s);Array.isArray(a)&&(a=a.map(u=>Je(u))),r(n,["contents"],a)}const l=i(e,["config"]);return l!=null&&Bl(l),n}function Yl(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let a=W(s);Array.isArray(a)&&(a=a.map(u=>u)),r(n,["contents"],a)}const l=i(e,["config"]);return l!=null&&Jl(l,n),n}function Wl(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["totalTokens"]);o!=null&&r(e,["totalTokens"],o);const s=i(t,["cachedContentTokenCount"]);return s!=null&&r(e,["cachedContentTokenCount"],s),e}function Kl(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["totalTokens"]);return o!=null&&r(e,["totalTokens"],o),e}function zl(t,e){const n={},o=i(e,["model"]);return o!=null&&r(n,["_url","name"],N(t,o)),n}function Ol(t,e){const n={},o=i(e,["model"]);return o!=null&&r(n,["_url","name"],N(t,o)),n}function Xl(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function Ql(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}function Zl(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(t,["negativePrompt"]);e!==void 0&&s!=null&&r(e,["parameters","negativePrompt"],s);const l=i(t,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const a=i(t,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const u=i(t,["guidanceScale"]);e!==void 0&&u!=null&&r(e,["parameters","guidanceScale"],u);const c=i(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&r(e,["parameters","safetySetting"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const h=i(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&r(e,["parameters","includeSafetyAttributes"],h);const p=i(t,["includeRaiReason"]);e!==void 0&&p!=null&&r(e,["parameters","includeRaiReason"],p);const m=i(t,["language"]);e!==void 0&&m!=null&&r(e,["parameters","language"],m);const v=i(t,["outputMimeType"]);e!==void 0&&v!=null&&r(e,["parameters","outputOptions","mimeType"],v);const y=i(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","compressionQuality"],y);const g=i(t,["addWatermark"]);e!==void 0&&g!=null&&r(e,["parameters","addWatermark"],g);const T=i(t,["labels"]);e!==void 0&&T!=null&&r(e,["labels"],T);const C=i(t,["editMode"]);e!==void 0&&C!=null&&r(e,["parameters","editMode"],C);const E=i(t,["baseSteps"]);return e!==void 0&&E!=null&&r(e,["parameters","editConfig","baseSteps"],E),n}function jl(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["prompt"]);s!=null&&r(n,["instances[0]","prompt"],s);const l=i(e,["referenceImages"]);if(l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>tu(c))),r(n,["instances[0]","referenceImages"],u)}const a=i(e,["config"]);return a!=null&&Zl(a,n),n}function ea(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>$e(l))),r(e,["generatedImages"],s)}return e}function ta(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&r(e,["requests[]","taskType"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&r(e,["requests[]","title"],s);const l=i(t,["outputDimensionality"]);if(e!==void 0&&l!=null&&r(e,["requests[]","outputDimensionality"],l),i(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function na(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&r(e,["instances[]","task_type"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&r(e,["instances[]","title"],s);const l=i(t,["outputDimensionality"]);e!==void 0&&l!=null&&r(e,["parameters","outputDimensionality"],l);const a=i(t,["mimeType"]);e!==void 0&&a!=null&&r(e,["instances[]","mimeType"],a);const u=i(t,["autoTruncate"]);return e!==void 0&&u!=null&&r(e,["parameters","autoTruncate"],u),n}function oa(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let u=_t(t,s);Array.isArray(u)&&(u=u.map(c=>c)),r(n,["requests[]","content"],u)}const l=i(e,["config"]);l!=null&&ta(l,n);const a=i(e,["model"]);return a!==void 0&&r(n,["requests[]","model"],N(t,a)),n}function ia(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let a=_t(t,s);Array.isArray(a)&&(a=a.map(u=>u)),r(n,["instances[]","content"],a)}const l=i(e,["config"]);return l!=null&&na(l,n),n}function sa(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["embeddings"],l)}const s=i(t,["metadata"]);return s!=null&&r(e,["metadata"],s),e}function ra(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["predictions[]","embeddings"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Hl(a))),r(e,["embeddings"],l)}const s=i(t,["metadata"]);return s!=null&&r(e,["metadata"],s),e}function la(t){const e={},n=i(t,["endpoint"]);n!=null&&r(e,["name"],n);const o=i(t,["deployedModelId"]);return o!=null&&r(e,["deployedModelId"],o),e}function aa(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function ua(t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const o=i(t,["args"]);o!=null&&r(e,["args"],o);const s=i(t,["name"]);if(s!=null&&r(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function da(t){const e={},n=i(t,["allowedFunctionNames"]);n!=null&&r(e,["allowedFunctionNames"],n);const o=i(t,["mode"]);if(o!=null&&r(e,["mode"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ca(t){const e={},n=i(t,["description"]);n!=null&&r(e,["description"],n);const o=i(t,["name"]);o!=null&&r(e,["name"],o);const s=i(t,["parameters"]);s!=null&&r(e,["parameters"],s);const l=i(t,["parametersJsonSchema"]);l!=null&&r(e,["parametersJsonSchema"],l);const a=i(t,["response"]);a!=null&&r(e,["response"],a);const u=i(t,["responseJsonSchema"]);if(u!=null&&r(e,["responseJsonSchema"],u),i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function fa(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&r(n,["systemInstruction"],Je(G(s)));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const h=i(e,["responseLogprobs"]);h!=null&&r(o,["responseLogprobs"],h);const p=i(e,["logprobs"]);p!=null&&r(o,["logprobs"],p);const m=i(e,["presencePenalty"]);m!=null&&r(o,["presencePenalty"],m);const v=i(e,["frequencyPenalty"]);v!=null&&r(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const g=i(e,["responseMimeType"]);g!=null&&r(o,["responseMimeType"],g);const T=i(e,["responseSchema"]);T!=null&&r(o,["responseSchema"],Et(T));const C=i(e,["responseJsonSchema"]);if(C!=null&&r(o,["responseJsonSchema"],C),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=i(e,["safetySettings"]);if(n!==void 0&&E!=null){let D=E;Array.isArray(D)&&(D=D.map(J=>nu(J))),r(n,["safetySettings"],D)}const I=i(e,["tools"]);if(n!==void 0&&I!=null){let D=ve(I);Array.isArray(D)&&(D=D.map(J=>uu(ge(J)))),r(n,["tools"],D)}const S=i(e,["toolConfig"]);if(n!==void 0&&S!=null&&r(n,["toolConfig"],au(S)),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=i(e,["cachedContent"]);n!==void 0&&R!=null&&r(n,["cachedContent"],te(t,R));const w=i(e,["responseModalities"]);w!=null&&r(o,["responseModalities"],w);const x=i(e,["mediaResolution"]);x!=null&&r(o,["mediaResolution"],x);const A=i(e,["speechConfig"]);if(A!=null&&r(o,["speechConfig"],Ct(A)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=i(e,["thinkingConfig"]);P!=null&&r(o,["thinkingConfig"],P);const U=i(e,["imageConfig"]);U!=null&&r(o,["imageConfig"],Ha(U));const Q=i(e,["enableEnhancedCivicAnswers"]);return Q!=null&&r(o,["enableEnhancedCivicAnswers"],Q),o}function pa(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&r(n,["systemInstruction"],G(s));const l=i(e,["temperature"]);l!=null&&r(o,["temperature"],l);const a=i(e,["topP"]);a!=null&&r(o,["topP"],a);const u=i(e,["topK"]);u!=null&&r(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&r(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&r(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&r(o,["stopSequences"],f);const h=i(e,["responseLogprobs"]);h!=null&&r(o,["responseLogprobs"],h);const p=i(e,["logprobs"]);p!=null&&r(o,["logprobs"],p);const m=i(e,["presencePenalty"]);m!=null&&r(o,["presencePenalty"],m);const v=i(e,["frequencyPenalty"]);v!=null&&r(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&r(o,["seed"],y);const g=i(e,["responseMimeType"]);g!=null&&r(o,["responseMimeType"],g);const T=i(e,["responseSchema"]);T!=null&&r(o,["responseSchema"],Et(T));const C=i(e,["responseJsonSchema"]);C!=null&&r(o,["responseJsonSchema"],C);const E=i(e,["routingConfig"]);E!=null&&r(o,["routingConfig"],E);const I=i(e,["modelSelectionConfig"]);I!=null&&r(o,["modelConfig"],I);const S=i(e,["safetySettings"]);if(n!==void 0&&S!=null){let $=S;Array.isArray($)&&($=$.map(Te=>Te)),r(n,["safetySettings"],$)}const R=i(e,["tools"]);if(n!==void 0&&R!=null){let $=ve(R);Array.isArray($)&&($=$.map(Te=>Jo(ge(Te)))),r(n,["tools"],$)}const w=i(e,["toolConfig"]);n!==void 0&&w!=null&&r(n,["toolConfig"],w);const x=i(e,["labels"]);n!==void 0&&x!=null&&r(n,["labels"],x);const A=i(e,["cachedContent"]);n!==void 0&&A!=null&&r(n,["cachedContent"],te(t,A));const P=i(e,["responseModalities"]);P!=null&&r(o,["responseModalities"],P);const U=i(e,["mediaResolution"]);U!=null&&r(o,["mediaResolution"],U);const Q=i(e,["speechConfig"]);Q!=null&&r(o,["speechConfig"],Ct(Q));const D=i(e,["audioTimestamp"]);D!=null&&r(o,["audioTimestamp"],D);const J=i(e,["thinkingConfig"]);J!=null&&r(o,["thinkingConfig"],J);const le=i(e,["imageConfig"]);if(le!=null&&r(o,["imageConfig"],ba(le)),i(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}function no(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let a=W(s);Array.isArray(a)&&(a=a.map(u=>Je(u))),r(n,["contents"],a)}const l=i(e,["config"]);return l!=null&&r(n,["generationConfig"],fa(t,l,n)),n}function oo(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["contents"]);if(s!=null){let a=W(s);Array.isArray(a)&&(a=a.map(u=>u)),r(n,["contents"],a)}const l=i(e,["config"]);return l!=null&&r(n,["generationConfig"],pa(t,l,n)),n}function io(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Ll(d))),r(e,["candidates"],c)}const s=i(t,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(t,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(t,["responseId"]);a!=null&&r(e,["responseId"],a);const u=i(t,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function so(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>f)),r(e,["candidates"],d)}const s=i(t,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(t,["modelVersion"]);l!=null&&r(e,["modelVersion"],l);const a=i(t,["promptFeedback"]);a!=null&&r(e,["promptFeedback"],a);const u=i(t,["responseId"]);u!=null&&r(e,["responseId"],u);const c=i(t,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function ha(t,e){const n={};if(i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=i(t,["numberOfImages"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(t,["aspectRatio"]);e!==void 0&&s!=null&&r(e,["parameters","aspectRatio"],s);const l=i(t,["guidanceScale"]);if(e!==void 0&&l!=null&&r(e,["parameters","guidanceScale"],l),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=i(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&r(e,["parameters","safetySetting"],a);const u=i(t,["personGeneration"]);e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u);const c=i(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&r(e,["parameters","includeSafetyAttributes"],c);const d=i(t,["includeRaiReason"]);e!==void 0&&d!=null&&r(e,["parameters","includeRaiReason"],d);const f=i(t,["language"]);e!==void 0&&f!=null&&r(e,["parameters","language"],f);const h=i(t,["outputMimeType"]);e!==void 0&&h!=null&&r(e,["parameters","outputOptions","mimeType"],h);const p=i(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&r(e,["parameters","outputOptions","compressionQuality"],p),i(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(i(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=i(t,["imageSize"]);if(e!==void 0&&m!=null&&r(e,["parameters","sampleImageSize"],m),i(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function ma(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(t,["negativePrompt"]);e!==void 0&&s!=null&&r(e,["parameters","negativePrompt"],s);const l=i(t,["numberOfImages"]);e!==void 0&&l!=null&&r(e,["parameters","sampleCount"],l);const a=i(t,["aspectRatio"]);e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a);const u=i(t,["guidanceScale"]);e!==void 0&&u!=null&&r(e,["parameters","guidanceScale"],u);const c=i(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&r(e,["parameters","safetySetting"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const h=i(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&r(e,["parameters","includeSafetyAttributes"],h);const p=i(t,["includeRaiReason"]);e!==void 0&&p!=null&&r(e,["parameters","includeRaiReason"],p);const m=i(t,["language"]);e!==void 0&&m!=null&&r(e,["parameters","language"],m);const v=i(t,["outputMimeType"]);e!==void 0&&v!=null&&r(e,["parameters","outputOptions","mimeType"],v);const y=i(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","compressionQuality"],y);const g=i(t,["addWatermark"]);e!==void 0&&g!=null&&r(e,["parameters","addWatermark"],g);const T=i(t,["labels"]);e!==void 0&&T!=null&&r(e,["labels"],T);const C=i(t,["imageSize"]);e!==void 0&&C!=null&&r(e,["parameters","sampleImageSize"],C);const E=i(t,["enhancePrompt"]);return e!==void 0&&E!=null&&r(e,["parameters","enhancePrompt"],E),n}function ga(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["prompt"]);s!=null&&r(n,["instances[0]","prompt"],s);const l=i(e,["config"]);return l!=null&&ha(l,n),n}function va(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["prompt"]);s!=null&&r(n,["instances[0]","prompt"],s);const l=i(e,["config"]);return l!=null&&ma(l,n),n}function ya(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>Na(a))),r(e,["generatedImages"],l)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],qo(s)),e}function Ta(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>$e(a))),r(e,["generatedImages"],l)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],Bo(s)),e}function _a(t,e){const n={},o=i(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o),i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=i(t,["durationSeconds"]);if(e!==void 0&&s!=null&&r(e,["parameters","durationSeconds"],s),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=i(t,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=i(t,["resolution"]);e!==void 0&&a!=null&&r(e,["parameters","resolution"],a);const u=i(t,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),i(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=i(t,["negativePrompt"]);e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c);const d=i(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&r(e,["parameters","enhancePrompt"],d),i(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=i(t,["lastFrame"]);e!==void 0&&f!=null&&r(e,["instances[0]","lastFrame"],Ye(f));const h=i(t,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Cu(m))),r(e,["instances[0]","referenceImages"],p)}if(i(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(i(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Ea(t,e){const n={},o=i(t,["numberOfVideos"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(t,["outputGcsUri"]);e!==void 0&&s!=null&&r(e,["parameters","storageUri"],s);const l=i(t,["fps"]);e!==void 0&&l!=null&&r(e,["parameters","fps"],l);const a=i(t,["durationSeconds"]);e!==void 0&&a!=null&&r(e,["parameters","durationSeconds"],a);const u=i(t,["seed"]);e!==void 0&&u!=null&&r(e,["parameters","seed"],u);const c=i(t,["aspectRatio"]);e!==void 0&&c!=null&&r(e,["parameters","aspectRatio"],c);const d=i(t,["resolution"]);e!==void 0&&d!=null&&r(e,["parameters","resolution"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&r(e,["parameters","personGeneration"],f);const h=i(t,["pubsubTopic"]);e!==void 0&&h!=null&&r(e,["parameters","pubsubTopic"],h);const p=i(t,["negativePrompt"]);e!==void 0&&p!=null&&r(e,["parameters","negativePrompt"],p);const m=i(t,["enhancePrompt"]);e!==void 0&&m!=null&&r(e,["parameters","enhancePrompt"],m);const v=i(t,["generateAudio"]);e!==void 0&&v!=null&&r(e,["parameters","generateAudio"],v);const y=i(t,["lastFrame"]);e!==void 0&&y!=null&&r(e,["instances[0]","lastFrame"],X(y));const g=i(t,["referenceImages"]);if(e!==void 0&&g!=null){let E=g;Array.isArray(E)&&(E=E.map(I=>Su(I))),r(e,["instances[0]","referenceImages"],E)}const T=i(t,["mask"]);e!==void 0&&T!=null&&r(e,["instances[0]","mask"],Eu(T));const C=i(t,["compressionQuality"]);return e!==void 0&&C!=null&&r(e,["parameters","compressionQuality"],C),n}function Ca(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response","generateVideoResponse"]);return a!=null&&r(e,["response"],Ra(a)),e}function Sa(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response"]);return a!=null&&r(e,["response"],wa(a)),e}function Ia(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["prompt"]);s!=null&&r(n,["instances[0]","prompt"],s);const l=i(e,["image"]);l!=null&&r(n,["instances[0]","image"],Ye(l));const a=i(e,["video"]);a!=null&&r(n,["instances[0]","video"],$o(a));const u=i(e,["source"]);u!=null&&Ma(u,n);const c=i(e,["config"]);return c!=null&&_a(c,n),n}function Aa(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["prompt"]);s!=null&&r(n,["instances[0]","prompt"],s);const l=i(e,["image"]);l!=null&&r(n,["instances[0]","image"],X(l));const a=i(e,["video"]);a!=null&&r(n,["instances[0]","video"],Yo(a));const u=i(e,["source"]);u!=null&&Pa(u,n);const c=i(e,["config"]);return c!=null&&Ea(c,n),n}function Ra(t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Da(a))),r(e,["generatedVideos"],l)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function wa(t){const e={},n=i(t,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ua(a))),r(e,["generatedVideos"],l)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&r(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&r(e,["raiMediaFilteredReasons"],s),e}function Ma(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],Ye(s));const l=i(t,["video"]);return e!==void 0&&l!=null&&r(e,["instances[0]","video"],$o(l)),n}function Pa(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],X(s));const l=i(t,["video"]);return e!==void 0&&l!=null&&r(e,["instances[0]","video"],Yo(l)),n}function Na(t){const e={},n=i(t,["_self"]);n!=null&&r(e,["image"],qa(n));const o=i(t,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const s=i(t,["_self"]);return s!=null&&r(e,["safetyAttributes"],qo(s)),e}function $e(t){const e={},n=i(t,["_self"]);n!=null&&r(e,["image"],bo(n));const o=i(t,["raiFilteredReason"]);o!=null&&r(e,["raiFilteredReason"],o);const s=i(t,["_self"]);s!=null&&r(e,["safetyAttributes"],Bo(s));const l=i(t,["prompt"]);return l!=null&&r(e,["enhancedPrompt"],l),e}function xa(t){const e={},n=i(t,["_self"]);n!=null&&r(e,["mask"],bo(n));const o=i(t,["labels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),r(e,["labels"],s)}return e}function Da(t){const e={},n=i(t,["video"]);return n!=null&&r(e,["video"],Tu(n)),e}function Ua(t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],_u(n)),e}function ka(t){const e={},n=i(t,["modelSelectionConfig"]);n!=null&&r(e,["modelConfig"],n);const o=i(t,["responseJsonSchema"]);o!=null&&r(e,["responseJsonSchema"],o);const s=i(t,["audioTimestamp"]);s!=null&&r(e,["audioTimestamp"],s);const l=i(t,["candidateCount"]);l!=null&&r(e,["candidateCount"],l);const a=i(t,["enableAffectiveDialog"]);a!=null&&r(e,["enableAffectiveDialog"],a);const u=i(t,["frequencyPenalty"]);u!=null&&r(e,["frequencyPenalty"],u);const c=i(t,["logprobs"]);c!=null&&r(e,["logprobs"],c);const d=i(t,["maxOutputTokens"]);d!=null&&r(e,["maxOutputTokens"],d);const f=i(t,["mediaResolution"]);f!=null&&r(e,["mediaResolution"],f);const h=i(t,["presencePenalty"]);h!=null&&r(e,["presencePenalty"],h);const p=i(t,["responseLogprobs"]);p!=null&&r(e,["responseLogprobs"],p);const m=i(t,["responseMimeType"]);m!=null&&r(e,["responseMimeType"],m);const v=i(t,["responseModalities"]);v!=null&&r(e,["responseModalities"],v);const y=i(t,["responseSchema"]);y!=null&&r(e,["responseSchema"],y);const g=i(t,["routingConfig"]);g!=null&&r(e,["routingConfig"],g);const T=i(t,["seed"]);T!=null&&r(e,["seed"],T);const C=i(t,["speechConfig"]);C!=null&&r(e,["speechConfig"],C);const E=i(t,["stopSequences"]);E!=null&&r(e,["stopSequences"],E);const I=i(t,["temperature"]);I!=null&&r(e,["temperature"],I);const S=i(t,["thinkingConfig"]);S!=null&&r(e,["thinkingConfig"],S);const R=i(t,["topK"]);R!=null&&r(e,["topK"],R);const w=i(t,["topP"]);if(w!=null&&r(e,["topP"],w),i(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function La(t,e){const n={},o=i(e,["model"]);return o!=null&&r(n,["_url","name"],N(t,o)),n}function Fa(t,e){const n={},o=i(e,["model"]);return o!=null&&r(n,["_url","name"],N(t,o)),n}function Ga(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&r(e,["enableWidget"],n),e}function Va(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],n),e}function Ha(t){const e={},n=i(t,["aspectRatio"]);n!=null&&r(e,["aspectRatio"],n);const o=i(t,["imageSize"]);if(o!=null&&r(e,["imageSize"],o),i(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(i(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(i(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function ba(t){const e={},n=i(t,["aspectRatio"]);n!=null&&r(e,["aspectRatio"],n);const o=i(t,["imageSize"]);o!=null&&r(e,["imageSize"],o);const s=i(t,["personGeneration"]);s!=null&&r(e,["personGeneration"],s);const l=i(t,["outputMimeType"]);l!=null&&r(e,["imageOutputOptions","mimeType"],l);const a=i(t,["outputCompressionQuality"]);return a!=null&&r(e,["imageOutputOptions","compressionQuality"],a),e}function qa(t){const e={},n=i(t,["bytesBase64Encoded"]);n!=null&&r(e,["imageBytes"],ie(n));const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function bo(t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&r(e,["imageBytes"],ie(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Ye(t){const e={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=i(t,["imageBytes"]);n!=null&&r(e,["bytesBase64Encoded"],ie(n));const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function X(t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const o=i(t,["imageBytes"]);o!=null&&r(e,["bytesBase64Encoded"],ie(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Ba(t,e,n){const o={},s=i(e,["pageSize"]);n!==void 0&&s!=null&&r(n,["_query","pageSize"],s);const l=i(e,["pageToken"]);n!==void 0&&l!=null&&r(n,["_query","pageToken"],l);const a=i(e,["filter"]);n!==void 0&&a!=null&&r(n,["_query","filter"],a);const u=i(e,["queryBase"]);return n!==void 0&&u!=null&&r(n,["_url","models_url"],Uo(t,u)),o}function Ja(t,e,n){const o={},s=i(e,["pageSize"]);n!==void 0&&s!=null&&r(n,["_query","pageSize"],s);const l=i(e,["pageToken"]);n!==void 0&&l!=null&&r(n,["_query","pageToken"],l);const a=i(e,["filter"]);n!==void 0&&a!=null&&r(n,["_query","filter"],a);const u=i(e,["queryBase"]);return n!==void 0&&u!=null&&r(n,["_url","models_url"],Uo(t,u)),o}function $a(t,e){const n={},o=i(e,["config"]);return o!=null&&Ba(t,o,n),n}function Ya(t,e){const n={},o=i(e,["config"]);return o!=null&&Ja(t,o,n),n}function Wa(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["_self"]);if(s!=null){let l=ko(s);Array.isArray(l)&&(l=l.map(a=>lt(a))),r(e,["models"],l)}return e}function Ka(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["_self"]);if(s!=null){let l=ko(s);Array.isArray(l)&&(l=l.map(a=>at(a))),r(e,["models"],l)}return e}function za(t){const e={},n=i(t,["maskMode"]);n!=null&&r(e,["maskMode"],n);const o=i(t,["segmentationClasses"]);o!=null&&r(e,["maskClasses"],o);const s=i(t,["maskDilation"]);return s!=null&&r(e,["dilation"],s),e}function lt(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(t,["description"]);s!=null&&r(e,["description"],s);const l=i(t,["version"]);l!=null&&r(e,["version"],l);const a=i(t,["_self"]);a!=null&&r(e,["tunedModelInfo"],du(a));const u=i(t,["inputTokenLimit"]);u!=null&&r(e,["inputTokenLimit"],u);const c=i(t,["outputTokenLimit"]);c!=null&&r(e,["outputTokenLimit"],c);const d=i(t,["supportedGenerationMethods"]);d!=null&&r(e,["supportedActions"],d);const f=i(t,["temperature"]);f!=null&&r(e,["temperature"],f);const h=i(t,["maxTemperature"]);h!=null&&r(e,["maxTemperature"],h);const p=i(t,["topP"]);p!=null&&r(e,["topP"],p);const m=i(t,["topK"]);m!=null&&r(e,["topK"],m);const v=i(t,["thinking"]);return v!=null&&r(e,["thinking"],v),e}function at(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["displayName"]);o!=null&&r(e,["displayName"],o);const s=i(t,["description"]);s!=null&&r(e,["description"],s);const l=i(t,["versionId"]);l!=null&&r(e,["version"],l);const a=i(t,["deployedModels"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>la(p))),r(e,["endpoints"],h)}const u=i(t,["labels"]);u!=null&&r(e,["labels"],u);const c=i(t,["_self"]);c!=null&&r(e,["tunedModelInfo"],cu(c));const d=i(t,["defaultCheckpointId"]);d!=null&&r(e,["defaultCheckpointId"],d);const f=i(t,["checkpoints"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(p=>p)),r(e,["checkpoints"],h)}return e}function Oa(t){const e={},n=i(t,["mediaResolution"]);n!=null&&r(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&r(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&r(e,["executableCode"],s);const l=i(t,["fileData"]);l!=null&&r(e,["fileData"],aa(l));const a=i(t,["functionCall"]);a!=null&&r(e,["functionCall"],ua(a));const u=i(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&r(e,["inlineData"],kl(c));const d=i(t,["text"]);d!=null&&r(e,["text"],d);const f=i(t,["thought"]);f!=null&&r(e,["thought"],f);const h=i(t,["thoughtSignature"]);h!=null&&r(e,["thoughtSignature"],h);const p=i(t,["videoMetadata"]);return p!=null&&r(e,["videoMetadata"],p),e}function Xa(t){const e={},n=i(t,["productImage"]);return n!=null&&r(e,["image"],X(n)),e}function Qa(t,e){const n={},o=i(t,["numberOfImages"]);e!==void 0&&o!=null&&r(e,["parameters","sampleCount"],o);const s=i(t,["baseSteps"]);e!==void 0&&s!=null&&r(e,["parameters","baseSteps"],s);const l=i(t,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=i(t,["seed"]);e!==void 0&&a!=null&&r(e,["parameters","seed"],a);const u=i(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const c=i(t,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const d=i(t,["addWatermark"]);e!==void 0&&d!=null&&r(e,["parameters","addWatermark"],d);const f=i(t,["outputMimeType"]);e!==void 0&&f!=null&&r(e,["parameters","outputOptions","mimeType"],f);const h=i(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&r(e,["parameters","outputOptions","compressionQuality"],h);const p=i(t,["enhancePrompt"]);e!==void 0&&p!=null&&r(e,["parameters","enhancePrompt"],p);const m=i(t,["labels"]);return e!==void 0&&m!=null&&r(e,["labels"],m),n}function Za(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["source"]);s!=null&&eu(s,n);const l=i(e,["config"]);return l!=null&&Qa(l,n),n}function ja(t){const e={},n=i(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>$e(s))),r(e,["generatedImages"],o)}return e}function eu(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(t,["personImage"]);e!==void 0&&s!=null&&r(e,["instances[0]","personImage","image"],X(s));const l=i(t,["productImages"]);if(e!==void 0&&l!=null){let a=l;Array.isArray(a)&&(a=a.map(u=>Xa(u))),r(e,["instances[0]","productImages"],a)}return n}function tu(t){const e={},n=i(t,["referenceImage"]);n!=null&&r(e,["referenceImage"],X(n));const o=i(t,["referenceId"]);o!=null&&r(e,["referenceId"],o);const s=i(t,["referenceType"]);s!=null&&r(e,["referenceType"],s);const l=i(t,["maskImageConfig"]);l!=null&&r(e,["maskImageConfig"],za(l));const a=i(t,["controlImageConfig"]);a!=null&&r(e,["controlImageConfig"],ql(a));const u=i(t,["styleImageConfig"]);u!=null&&r(e,["styleImageConfig"],u);const c=i(t,["subjectImageConfig"]);return c!=null&&r(e,["subjectImageConfig"],c),e}function qo(t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const o=i(t,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const s=i(t,["contentType"]);return s!=null&&r(e,["contentType"],s),e}function Bo(t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const o=i(t,["safetyAttributes","scores"]);o!=null&&r(e,["scores"],o);const s=i(t,["contentType"]);return s!=null&&r(e,["contentType"],s),e}function nu(t){const e={},n=i(t,["category"]);if(n!=null&&r(e,["category"],n),i(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=i(t,["threshold"]);return o!=null&&r(e,["threshold"],o),e}function ou(t){const e={},n=i(t,["image"]);return n!=null&&r(e,["image"],X(n)),e}function iu(t,e){const n={},o=i(t,["mode"]);e!==void 0&&o!=null&&r(e,["parameters","mode"],o);const s=i(t,["maxPredictions"]);e!==void 0&&s!=null&&r(e,["parameters","maxPredictions"],s);const l=i(t,["confidenceThreshold"]);e!==void 0&&l!=null&&r(e,["parameters","confidenceThreshold"],l);const a=i(t,["maskDilation"]);e!==void 0&&a!=null&&r(e,["parameters","maskDilation"],a);const u=i(t,["binaryColorThreshold"]);e!==void 0&&u!=null&&r(e,["parameters","binaryColorThreshold"],u);const c=i(t,["labels"]);return e!==void 0&&c!=null&&r(e,["labels"],c),n}function su(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["source"]);s!=null&&lu(s,n);const l=i(e,["config"]);return l!=null&&iu(l,n),n}function ru(t){const e={},n=i(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>xa(s))),r(e,["generatedMasks"],o)}return e}function lu(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&r(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&r(e,["instances[0]","image"],X(s));const l=i(t,["scribbleImage"]);return e!==void 0&&l!=null&&r(e,["instances[0]","scribble"],ou(l)),n}function au(t){const e={},n=i(t,["retrievalConfig"]);n!=null&&r(e,["retrievalConfig"],n);const o=i(t,["functionCallingConfig"]);return o!=null&&r(e,["functionCallingConfig"],da(o)),e}function uu(t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=i(t,["computerUse"]);n!=null&&r(e,["computerUse"],n);const o=i(t,["fileSearch"]);o!=null&&r(e,["fileSearch"],o);const s=i(t,["codeExecution"]);if(s!=null&&r(e,["codeExecution"],s),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=i(t,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>h)),r(e,["functionDeclarations"],f)}const a=i(t,["googleMaps"]);a!=null&&r(e,["googleMaps"],Ga(a));const u=i(t,["googleSearch"]);u!=null&&r(e,["googleSearch"],Va(u));const c=i(t,["googleSearchRetrieval"]);c!=null&&r(e,["googleSearchRetrieval"],c);const d=i(t,["urlContext"]);return d!=null&&r(e,["urlContext"],d),e}function Jo(t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n);const o=i(t,["computerUse"]);if(o!=null&&r(e,["computerUse"],o),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=i(t,["codeExecution"]);s!=null&&r(e,["codeExecution"],s);const l=i(t,["enterpriseWebSearch"]);l!=null&&r(e,["enterpriseWebSearch"],l);const a=i(t,["functionDeclarations"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>ca(p))),r(e,["functionDeclarations"],h)}const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],u);const c=i(t,["googleSearch"]);c!=null&&r(e,["googleSearch"],c);const d=i(t,["googleSearchRetrieval"]);d!=null&&r(e,["googleSearchRetrieval"],d);const f=i(t,["urlContext"]);return f!=null&&r(e,["urlContext"],f),e}function du(t){const e={},n=i(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const o=i(t,["createTime"]);o!=null&&r(e,["createTime"],o);const s=i(t,["updateTime"]);return s!=null&&r(e,["updateTime"],s),e}function cu(t){const e={},n=i(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&r(e,["baseModel"],n);const o=i(t,["createTime"]);o!=null&&r(e,["createTime"],o);const s=i(t,["updateTime"]);return s!=null&&r(e,["updateTime"],s),e}function fu(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(t,["description"]);e!==void 0&&s!=null&&r(e,["description"],s);const l=i(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),n}function pu(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&r(e,["displayName"],o);const s=i(t,["description"]);e!==void 0&&s!=null&&r(e,["description"],s);const l=i(t,["defaultCheckpointId"]);return e!==void 0&&l!=null&&r(e,["defaultCheckpointId"],l),n}function hu(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","name"],N(t,o));const s=i(e,["config"]);return s!=null&&fu(s,n),n}function mu(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["config"]);return s!=null&&pu(s,n),n}function gu(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&r(e,["parameters","storageUri"],o);const s=i(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&r(e,["parameters","safetySetting"],s);const l=i(t,["personGeneration"]);e!==void 0&&l!=null&&r(e,["parameters","personGeneration"],l);const a=i(t,["includeRaiReason"]);e!==void 0&&a!=null&&r(e,["parameters","includeRaiReason"],a);const u=i(t,["outputMimeType"]);e!==void 0&&u!=null&&r(e,["parameters","outputOptions","mimeType"],u);const c=i(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&r(e,["parameters","outputOptions","compressionQuality"],c);const d=i(t,["enhanceInputImage"]);e!==void 0&&d!=null&&r(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=i(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&r(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const h=i(t,["labels"]);e!==void 0&&h!=null&&r(e,["labels"],h);const p=i(t,["numberOfImages"]);e!==void 0&&p!=null&&r(e,["parameters","sampleCount"],p);const m=i(t,["mode"]);return e!==void 0&&m!=null&&r(e,["parameters","mode"],m),n}function vu(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["_url","model"],N(t,o));const s=i(e,["image"]);s!=null&&r(n,["instances[0]","image"],X(s));const l=i(e,["upscaleFactor"]);l!=null&&r(n,["parameters","upscaleConfig","upscaleFactor"],l);const a=i(e,["config"]);return a!=null&&gu(a,n),n}function yu(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>$e(l))),r(e,["generatedImages"],s)}return e}function Tu(t){const e={},n=i(t,["uri"]);n!=null&&r(e,["uri"],n);const o=i(t,["encodedVideo"]);o!=null&&r(e,["videoBytes"],ie(o));const s=i(t,["encoding"]);return s!=null&&r(e,["mimeType"],s),e}function _u(t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&r(e,["videoBytes"],ie(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Eu(t){const e={},n=i(t,["image"]);n!=null&&r(e,["_self"],X(n));const o=i(t,["maskMode"]);return o!=null&&r(e,["maskMode"],o),e}function Cu(t){const e={},n=i(t,["image"]);n!=null&&r(e,["image"],Ye(n));const o=i(t,["referenceType"]);return o!=null&&r(e,["referenceType"],o),e}function Su(t){const e={},n=i(t,["image"]);n!=null&&r(e,["image"],X(n));const o=i(t,["referenceType"]);return o!=null&&r(e,["referenceType"],o),e}function $o(t){const e={},n=i(t,["uri"]);n!=null&&r(e,["uri"],n);const o=i(t,["videoBytes"]);o!=null&&r(e,["encodedVideo"],ie(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["encoding"],s),e}function Yo(t){const e={},n=i(t,["uri"]);n!=null&&r(e,["gcsUri"],n);const o=i(t,["videoBytes"]);o!=null&&r(e,["bytesBase64Encoded"],ie(o));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Iu(t,e){const n={},o=i(t,["displayName"]);return e!==void 0&&o!=null&&r(e,["displayName"],o),n}function Au(t){const e={},n=i(t,["config"]);return n!=null&&Iu(n,e),e}function Ru(t,e){const n={},o=i(t,["force"]);return e!==void 0&&o!=null&&r(e,["_query","force"],o),n}function wu(t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],n);const o=i(t,["config"]);return o!=null&&Ru(o,e),e}function Mu(t){const e={},n=i(t,["name"]);return n!=null&&r(e,["_url","name"],n),e}function Pu(t,e){const n={},o=i(t,["customMetadata"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["customMetadata"],l)}const s=i(t,["chunkingConfig"]);return e!==void 0&&s!=null&&r(e,["chunkingConfig"],s),n}function Nu(t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const o=i(t,["metadata"]);o!=null&&r(e,["metadata"],o);const s=i(t,["done"]);s!=null&&r(e,["done"],s);const l=i(t,["error"]);l!=null&&r(e,["error"],l);const a=i(t,["response"]);return a!=null&&r(e,["response"],Du(a)),e}function xu(t){const e={},n=i(t,["fileSearchStoreName"]);n!=null&&r(e,["_url","file_search_store_name"],n);const o=i(t,["fileName"]);o!=null&&r(e,["fileName"],o);const s=i(t,["config"]);return s!=null&&Pu(s,e),e}function Du(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&r(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&r(e,["documentName"],s),e}function Uu(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),n}function ku(t){const e={},n=i(t,["config"]);return n!=null&&Uu(n,e),e}function Lu(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["fileSearchStores"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["fileSearchStores"],l)}return e}function Wo(t,e){const n={},o=i(t,["mimeType"]);e!==void 0&&o!=null&&r(e,["mimeType"],o);const s=i(t,["displayName"]);e!==void 0&&s!=null&&r(e,["displayName"],s);const l=i(t,["customMetadata"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>c)),r(e,["customMetadata"],u)}const a=i(t,["chunkingConfig"]);return e!==void 0&&a!=null&&r(e,["chunkingConfig"],a),n}function Fu(t){const e={},n=i(t,["fileSearchStoreName"]);n!=null&&r(e,["_url","file_search_store_name"],n);const o=i(t,["config"]);return o!=null&&Wo(o,e),e}function Gu(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&r(e,["sdkHttpResponse"],n),e}const Vu="Content-Type",Hu="X-Server-Timeout",bu="User-Agent",ut="x-goog-api-client",qu="1.37.0",Bu=`google-genai-sdk/${qu}`,Ju="v1beta1",$u="v1beta";class Yu{constructor(e){var n,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Ju,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:$u,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,o){const s=[this.getRequestUrlInternal(n)];return o&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,o);if(e.queryParams)for(const[a,u]of Object.entries(e.queryParams))s.searchParams.append(a,String(u));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,n,s.toString(),e.abortSignal),this.unaryApiCall(s,l,e.httpMethod)}patchHttpOptions(e,n){const o=JSON.parse(JSON.stringify(e));for(const[s,l]of Object.entries(n))typeof l=="object"?o[s]=Object.assign(Object.assign({},o[s]),l):l!==void 0&&(o[s]=l);return o}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,o);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,n,s.toString(),e.abortSignal),this.streamApiCall(s,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,o,s){if(n&&n.timeout||s){const l=new AbortController,a=l.signal;if(n.timeout&&n?.timeout>0){const u=setTimeout(()=>l.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}s&&s.addEventListener("abort",()=>{l.abort()}),e.signal=a}return n&&n.extraBody!==null&&Wu(e,n.extraBody),e.headers=await this.getHeadersInternal(n,o),e}async unaryApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async s=>(await ro(s),new it(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async s=>(await ro(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return z(this,arguments,function*(){var o;const s=(o=e?.body)===null||o===void 0?void 0:o.getReader(),l=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let a="";const u="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:f}=yield M(s.read());if(d){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=l.decode(f,{stream:!0});try{const v=JSON.parse(h);if("error"in v){const y=JSON.parse(JSON.stringify(v.error)),g=y.status,T=y.code,C=`got status: ${g}. ${JSON.stringify(v)}`;if(T>=400&&T<600)throw new Be({message:C,status:T})}}catch(v){if(v.name==="ApiError")throw v}a+=h;let p=-1,m=0;for(;;){p=-1,m=0;for(const g of c){const T=a.indexOf(g);T!==-1&&(p===-1||T<p)&&(p=T,m=g.length)}if(p===-1)break;const v=a.substring(0,p);a=a.substring(p+m);const y=v.trim();if(y.startsWith(u)){const g=y.substring(u.length).trim();try{const T=new Response(g,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield M(new it(T))}catch(T){throw new Error(`exception parsing stream chunk ${g}. ${T}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},n=Bu+" "+this.clientOptions.userAgentExtra;return e[bu]=n,e[ut]=n,e[Vu]="application/json",e}async getHeadersInternal(e,n){const o=new Headers;if(e&&e.headers){for(const[s,l]of Object.entries(e.headers))o.append(s,l);e.timeout&&e.timeout>0&&o.append(Hu,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,n),o}getFileName(e){var n;let o="";return typeof e=="string"&&(o=e.replace(/[/\\]+$/,""),o=(n=o.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),o}async uploadFile(e,n){var o;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const l=this.clientOptions.uploader,a=await l.stat(e);s.sizeBytes=String(a.size);const u=(o=n?.mimeType)!==null&&o!==void 0?o:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const c={file:s},d=this.getFileName(e),f=_("upload/v1beta/files",c._url),h=await this.fetchUploadUrl(f,s.sizeBytes,s.mimeType,d,c,n?.httpOptions);return l.upload(e,h,this)}async uploadFileToFileSearchStore(e,n,o){var s;const l=this.clientOptions.uploader,a=await l.stat(n),u=String(a.size),c=(s=o?.mimeType)!==null&&s!==void 0?s:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),h={};o!=null&&Wo(o,h);const p=await this.fetchUploadUrl(d,u,c,f,h,o?.httpOptions);return l.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,o,s,l,a){var u;let c={};a?c=a:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${o}`},s?{"X-Goog-Upload-File-Name":s}:{})};const d=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:c});if(!d||!d?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(u=d?.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function ro(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const s=JSON.stringify(o);throw n>=400&&n<600?new Be({message:s,status:n}):new Error(s)}}function Wu(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const l=JSON.parse(t.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))n=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(l,a){const u=Object.assign({},l);for(const c in a)if(Object.prototype.hasOwnProperty.call(a,c)){const d=a[c],f=u[c];d&&typeof d=="object"&&!Array.isArray(d)&&f&&typeof f=="object"&&!Array.isArray(f)?u[c]=o(f,d):(f&&d&&typeof f!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof f}, New type: ${typeof d}. Overwriting.`),u[c]=d)}return u}const s=o(n,e);t.body=JSON.stringify(s)}const Ku="mcp_used/unknown";let zu=!1;function Ko(t){for(const e of t)if(Ou(e)||typeof e=="object"&&"inputSchema"in e)return!0;return zu}function zo(t){var e;const n=(e=t[ut])!==null&&e!==void 0?e:"";t[ut]=(n+` ${Ku}`).trimStart()}function Ou(t){return t!==null&&typeof t=="object"&&t instanceof It}function Xu(t){return z(this,arguments,function*(n,o=100){let s,l=0;for(;l<o;){const a=yield M(n.listTools({cursor:s}));for(const u of a.tools)yield yield M(u),l++;if(!a.nextCursor)break;s=a.nextCursor}})}class It{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new It(e,n)}async initialize(){var e,n,o,s;if(this.mcpTools.length>0)return;const l={},a=[];for(const f of this.mcpClients)try{for(var u=!0,c=(n=void 0,O(Xu(f))),d;d=await c.next(),e=d.done,!e;u=!0){s=d.value,u=!1;const h=s;a.push(h);const p=h.name;if(l[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);l[p]=f}}catch(h){n={error:h}}finally{try{!u&&!e&&(o=c.return)&&await o.call(c)}finally{if(n)throw n.error}}this.mcpTools=a,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),ws(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[o.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const a=await s.callTool({name:o.name,arguments:o.args},void 0,l);n.push({functionResponse:{name:o.name,response:a.isError?{error:a}:a}})}return n}}async function Qu(t,e,n){const o=new Ts;let s;n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),Object.assign(o,s),e(o)}class Zu{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o}async connect(e){var n,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),a=td(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${u}`;let d=()=>{};const f=new Promise(E=>{d=E}),h=e.callbacks,p=function(){d({})},m=this.apiClient,v={onopen:p,onmessage:E=>{Qu(m,h.onmessage,E)},onerror:(n=h?.onerror)!==null&&n!==void 0?n:function(E){},onclose:(o=h?.onclose)!==null&&o!==void 0?o:function(E){}},y=this.webSocketFactory.create(c,ed(a),v);y.connect(),await f;const C={setup:{model:N(this.apiClient,e.model)}};return y.send(JSON.stringify(C)),new ju(y,this.apiClient)}}class ju{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Il(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Sl(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(ce.PLAY)}pause(){this.sendPlaybackControl(ce.PAUSE)}stop(){this.sendPlaybackControl(ce.STOP)}resetContext(){this.sendPlaybackControl(ce.RESET_CONTEXT)}close(){this.conn.close()}}function ed(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function td(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}const nd="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function od(t,e,n){const o=new ys;let s;n.data instanceof Blob?s=await n.data.text():n.data instanceof ArrayBuffer?s=new TextDecoder().decode(n.data):s=n.data;const l=JSON.parse(s);if(t.isVertexAI()){const a=wl(l);Object.assign(o,a)}else Object.assign(o,l);e(o)}class id{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o,this.music=new Zu(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,o,s,l,a,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&Ko(e.config.tools)&&zo(h);const p=ad(h);if(this.apiClient.isVertexAI())f=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f);else{const A=this.apiClient.getApiKey();let P="BidiGenerateContent",U="key";A?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",U="access_token"),f=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${P}?${U}=${A}`}let m=()=>{};const v=new Promise(A=>{m=A}),y=e.callbacks,g=function(){var A;(A=y?.onopen)===null||A===void 0||A.call(y),m({})},T=this.apiClient,C={onopen:g,onmessage:A=>{od(T,y.onmessage,A)},onerror:(n=y?.onerror)!==null&&n!==void 0?n:function(A){},onclose:(o=y?.onclose)!==null&&o!==void 0?o:function(A){}},E=this.webSocketFactory.create(f,ld(p),C);E.connect(),await v;let I=N(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const A=this.apiClient.getProject(),P=this.apiClient.getLocation();I=`projects/${A}/locations/${P}/`+I}let S={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Se.AUDIO]}:e.config.responseModalities=[Se.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R=(u=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[],w=[];for(const A of R)if(this.isCallableTool(A)){const P=A;w.push(await P.tool())}else w.push(A);w.length>0&&(e.config.tools=w);const x={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?S=Cl(this.apiClient,x):S=El(this.apiClient,x),delete S.config,E.send(JSON.stringify(S)),new rd(E,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const sd={turnComplete:!0};class rd{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let o=[];try{o=W(n.turns),e.isVertexAI()||(o=o.map(s=>Je(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let o=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?o=n.functionResponses:o=[n.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const l of o){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(nd)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},sd),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Rl(e)}:n={realtimeInput:Al(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function ld(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function ad(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}const lo=10;function ao(t){var e,n,o;if(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const a of(n=t?.tools)!==null&&n!==void 0?n:[])if(he(a)){s=!0;break}if(!s)return!0;const l=(o=t?.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function he(t){return"callTool"in t&&typeof t.callTool=="function"}function ud(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(s=>he(s)))!==null&&o!==void 0?o:!1}function uo(t){var e;const n=[];return!((e=t?.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((o,s)=>{if(he(o))return;const l=o;l.functionDeclarations&&l.functionDeclarations.length>0&&n.push(s)}),n}function co(t){var e;return!(!((e=t?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class dd extends ee{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var o,s,l,a,u;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!ud(n)||ao(n.config))return await this.generateContentInternal(c);const d=uo(n);if(d.length>0){const y=d.map(g=>`tools[${g}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${y}.`)}let f,h;const p=W(c.contents),m=(l=(s=(o=c.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&l!==void 0?l:lo;let v=0;for(;v<m&&(f=await this.generateContentInternal(c),!(!f.functionCalls||f.functionCalls.length===0));){const y=f.candidates[0].content,g=[];for(const T of(u=(a=n.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[])if(he(T)){const E=await T.callTool(f.functionCalls);g.push(...E)}v++,h={role:"user",parts:g},c.contents=W(c.contents),c.contents.push(y),c.contents.push(h),co(c.config)&&(p.push(y),p.push(h))}return co(c.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var o,s,l,a,u;if(this.maybeMoveToResponseJsonSchem(n),ao(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const c=uo(n);if(c.length>0){const h=c.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(l=(s=(o=n?.config)===null||o===void 0?void 0:o.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||l===void 0?void 0:l.streamFunctionCallArguments,f=(u=(a=n?.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(d&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(o=>{var s;let l;const a=[];if(o?.generatedImages)for(const c of o.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?l=c?.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l,sdkHttpResponse:o.sdkHttpResponse}:u={generatedImages:a,sdkHttpResponse:o.sdkHttpResponse},u}),this.list=async n=>{var o;const a={config:Object.assign(Object.assign({},{queryBase:!0}),n?.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((o=a.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new re(j.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async n=>{const o={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(o.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async n=>{let o={numberOfImages:1,mode:"upscale"};n.config&&(o=Object.assign(Object.assign({},o),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:o};return await this.upscaleImageInternal(s)},this.generateVideos=async n=>{var o,s,l,a,u,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=n.video)===null||o===void 0)&&o.uri&&(!((s=n.video)===null||s===void 0)&&s.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((a=(l=n.source)===null||l===void 0?void 0:l.video)===null||a===void 0)&&a.uri&&(!((c=(u=n.source)===null||u===void 0?void 0:u.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,o,s;const l=(n=e.config)===null||n===void 0?void 0:n.tools;if(!l)return e;const a=await Promise.all(l.map(async c=>he(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(u.config.tools=a,e.config&&e.config.tools&&Ko(e.config.tools)){const c=(s=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),zo(d),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return u}async initAfcToolsMap(e){var n,o,s;const l=new Map;for(const a of(o=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&o!==void 0?o:[])if(he(a)){const u=a,c=await u.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(l.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);l.set(d.name,u)}}return l}async processAfcStream(e){var n,o,s;const l=(s=(o=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&s!==void 0?s:lo;let a=!1,u=0;const c=await this.initAfcToolsMap(e);return(function(d,f,h){return z(this,arguments,function*(){for(var p,m,v,y,g,T;u<l;){a&&(u++,a=!1);const S=yield M(d.processParamsMaybeAddMcpUsage(h)),R=yield M(d.generateContentStreamInternal(S)),w=[],x=[];try{for(var C=!0,E=(m=void 0,O(R)),I;I=yield M(E.next()),p=I.done,!p;C=!0){y=I.value,C=!1;const A=y;if(yield yield M(A),A.candidates&&(!((g=A.candidates[0])===null||g===void 0)&&g.content)){x.push(A.candidates[0].content);for(const P of(T=A.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(u<l&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(P.functionCall.name)){const U=yield M(f.get(P.functionCall.name).callTool([P.functionCall]));w.push(...U)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(A){m={error:A}}finally{try{!C&&!p&&(v=E.return)&&(yield M(v.call(E)))}finally{if(m)throw m.error}}if(w.length>0){a=!0;const A=new _e;A.candidates=[{content:{role:"user",parts:w}}],yield yield M(A);const P=[];P.push(...x),P.push({role:"user",parts:w});const U=W(h.contents).concat(P);h.contents=U}else break}})})(this,c,e)}async generateContentInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=oo(this.apiClient,e);return u=_("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=so(f),p=new _e;return Object.assign(p,h),p})}else{const d=no(this.apiClient,e);return u=_("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=io(f),p=new _e;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=oo(this.apiClient,e);return u=_("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(h){return z(this,arguments,function*(){var p,m,v,y;try{for(var g=!0,T=O(h),C;C=yield M(T.next()),p=C.done,!p;g=!0){y=C.value,g=!1;const E=y,I=so(yield M(E.json()));I.sdkHttpResponse={headers:E.headers};const S=new _e;Object.assign(S,I),yield yield M(S)}}catch(E){m={error:E}}finally{try{!g&&!p&&(v=T.return)&&(yield M(v.call(T)))}finally{if(m)throw m.error}}})})}else{const d=no(this.apiClient,e);return u=_("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(h){return z(this,arguments,function*(){var p,m,v,y;try{for(var g=!0,T=O(h),C;C=yield M(T.next()),p=C.done,!p;g=!0){y=C.value,g=!1;const E=y,I=io(yield M(E.json()));I.sdkHttpResponse={headers:E.headers};const S=new _e;Object.assign(S,I),yield yield M(S)}}catch(E){m={error:E}}finally{try{!g&&!p&&(v=T.return)&&(yield M(v.call(T)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ia(this.apiClient,e);return u=_("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=ra(f),p=new Hn;return Object.assign(p,h),p})}else{const d=oa(this.apiClient,e);return u=_("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=sa(f),p=new Hn;return Object.assign(p,h),p})}}async generateImagesInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=va(this.apiClient,e);return u=_("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Ta(f),p=new bn;return Object.assign(p,h),p})}else{const d=ga(this.apiClient,e);return u=_("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=ya(f),p=new bn;return Object.assign(p,h),p})}}async editImageInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=jl(this.apiClient,e);return l=_("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=ea(c),f=new ls;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=vu(this.apiClient,e);return l=_("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=yu(c),f=new as;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Za(this.apiClient,e);return l=_("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=ja(c),f=new us;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=su(this.apiClient,e);return l=_("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=ru(c),f=new ds;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Fa(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>at(f))}else{const d=La(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>lt(f))}}async listInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ya(this.apiClient,e);return u=_("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Ka(f),p=new qn;return Object.assign(p,h),p})}else{const d=$a(this.apiClient,e);return u=_("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Wa(f),p=new qn;return Object.assign(p,h),p})}}async update(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=mu(this.apiClient,e);return u=_("{model}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>at(f))}else{const d=hu(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>lt(f))}}async delete(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ol(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Ql(f),p=new Bn;return Object.assign(p,h),p})}else{const d=zl(this.apiClient,e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Xl(f),p=new Bn;return Object.assign(p,h),p})}}async countTokens(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Yl(this.apiClient,e);return u=_("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Kl(f),p=new Jn;return Object.assign(p,h),p})}else{const d=$l(this.apiClient,e);return u=_("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Wl(f),p=new Jn;return Object.assign(p,h),p})}}async computeTokens(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Gl(this.apiClient,e);return l=_("{model}:computeTokens",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=Vl(c),f=new cs;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Aa(this.apiClient,e);return u=_("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>{const h=Sa(f),p=new Ge;return Object.assign(p,h),p})}else{const d=Ia(this.apiClient,e);return u=_("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const h=Ca(f),p=new Ge;return Object.assign(p,h),p})}}}class cd extends ee{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let l;o&&"httpOptions"in o&&(l=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:l}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let l;o&&"httpOptions"in o&&(l=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:l}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ts(e);return u=_("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a}else{const d=es(e);return u=_("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a}}async fetchPredictVideosOperationInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Ki(e);return l=_("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}function fd(t){const e={},n=i(t,["data"]);if(n!=null&&r(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function pd(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Cd(l))),r(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&r(e,["role"],o),e}function hd(t,e,n){const o={},s=i(e,["expireTime"]);n!==void 0&&s!=null&&r(n,["expireTime"],s);const l=i(e,["newSessionExpireTime"]);n!==void 0&&l!=null&&r(n,["newSessionExpireTime"],l);const a=i(e,["uses"]);n!==void 0&&a!=null&&r(n,["uses"],a);const u=i(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&r(n,["bidiGenerateContentSetup"],Ed(t,u));const c=i(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&r(n,["fieldMask"],c),o}function md(t,e){const n={},o=i(e,["config"]);return o!=null&&r(n,["config"],hd(t,o,n)),n}function gd(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&r(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&r(e,["mimeType"],o),e}function vd(t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const o=i(t,["args"]);o!=null&&r(e,["args"],o);const s=i(t,["name"]);if(s!=null&&r(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function yd(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&r(e,["enableWidget"],n),e}function Td(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&r(e,["timeRangeFilter"],n),e}function _d(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&r(e,["setup","generationConfig"],o);const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig","responseModalities"],s);const l=i(t,["temperature"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","temperature"],l);const a=i(t,["topP"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","seed"],f);const h=i(t,["speechConfig"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","speechConfig"],St(h));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","thinkingConfig"],p);const m=i(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","enableAffectiveDialog"],m);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&r(e,["setup","systemInstruction"],pd(G(v)));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let R=ve(y);Array.isArray(R)&&(R=R.map(w=>Id(ge(w)))),r(e,["setup","tools"],R)}const g=i(t,["sessionResumption"]);e!==void 0&&g!=null&&r(e,["setup","sessionResumption"],Sd(g));const T=i(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&r(e,["setup","inputAudioTranscription"],T);const C=i(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","outputAudioTranscription"],C);const E=i(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],E);const I=i(t,["contextWindowCompression"]);e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],I);const S=i(t,["proactivity"]);if(e!==void 0&&S!=null&&r(e,["setup","proactivity"],S),i(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Ed(t,e){const n={},o=i(e,["model"]);o!=null&&r(n,["setup","model"],N(t,o));const s=i(e,["config"]);return s!=null&&r(n,["config"],_d(s,n)),n}function Cd(t){const e={},n=i(t,["mediaResolution"]);n!=null&&r(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&r(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&r(e,["executableCode"],s);const l=i(t,["fileData"]);l!=null&&r(e,["fileData"],gd(l));const a=i(t,["functionCall"]);a!=null&&r(e,["functionCall"],vd(a));const u=i(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&r(e,["inlineData"],fd(c));const d=i(t,["text"]);d!=null&&r(e,["text"],d);const f=i(t,["thought"]);f!=null&&r(e,["thought"],f);const h=i(t,["thoughtSignature"]);h!=null&&r(e,["thoughtSignature"],h);const p=i(t,["videoMetadata"]);return p!=null&&r(e,["videoMetadata"],p),e}function Sd(t){const e={},n=i(t,["handle"]);if(n!=null&&r(e,["handle"],n),i(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Id(t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=i(t,["computerUse"]);n!=null&&r(e,["computerUse"],n);const o=i(t,["fileSearch"]);o!=null&&r(e,["fileSearch"],o);const s=i(t,["codeExecution"]);if(s!=null&&r(e,["codeExecution"],s),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=i(t,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(h=>h)),r(e,["functionDeclarations"],f)}const a=i(t,["googleMaps"]);a!=null&&r(e,["googleMaps"],yd(a));const u=i(t,["googleSearch"]);u!=null&&r(e,["googleSearch"],Td(u));const c=i(t,["googleSearchRetrieval"]);c!=null&&r(e,["googleSearchRetrieval"],c);const d=i(t,["urlContext"]);return d!=null&&r(e,["urlContext"],d),e}function Ad(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const s=Object.keys(o).map(l=>`${n}.${l}`);e.push(...s)}else e.push(n)}return e.join(",")}function Rd(t,e){let n=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const l=o.setup;typeof l=="object"&&l!==null?(t.bidiGenerateContentSetup=l,n=l):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const s=t.fieldMask;if(n){const l=Ad(n);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)l?t.fieldMask=l:delete t.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];s.length>0&&(u=s.map(d=>a.includes(d)?`generationConfig.${d}`:d));const c=[];l&&c.push(l),u.length>0&&c.push(...u),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?t.fieldMask=s.join(","):delete t.fieldMask;return t}class wd extends ee{constructor(e){super(),this.apiClient=e}async create(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=md(this.apiClient,e);l=_("auth_tokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=Rd(u,e.config);return s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}}function Md(t,e){const n={},o=i(t,["force"]);return e!==void 0&&o!=null&&r(e,["_query","force"],o),n}function Pd(t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],n);const o=i(t,["config"]);return o!=null&&Md(o,e),e}function Nd(t){const e={},n=i(t,["name"]);return n!=null&&r(e,["_url","name"],n),e}function xd(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&r(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&r(e,["_query","pageToken"],s),n}function Dd(t){const e={},n=i(t,["parent"]);n!=null&&r(e,["_url","parent"],n);const o=i(t,["config"]);return o!=null&&xd(o,e),e}function Ud(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&r(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&r(e,["nextPageToken"],o);const s=i(t,["documents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>a)),r(e,["documents"],l)}return e}class kd extends ee{constructor(e){super(),this.apiClient=e,this.list=async n=>new re(j.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:n.parent,config:o.config}),await this.listInternal(n),n)}async get(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Nd(e);return l=_("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Pd(e);s=_("{name}",a._url),l=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Dd(e);return l=_("{parent}/documents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Ud(c),f=new fs;return Object.assign(f,d),f})}}}class Ld extends ee{constructor(e,n=new kd(e)){super(),this.apiClient=e,this.documents=n,this.list=async(o={})=>new re(j.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(o),o)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Au(e);return l=_("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async get(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Mu(e);return l=_("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=wu(e);s=_("{name}",a._url),l=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ku(e);return l=_("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Lu(c),f=new ps;return Object.assign(f,d),f})}}async uploadToFileSearchStoreInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Fu(e);return l=_("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Gu(c),f=new hs;return Object.assign(f,d),f})}}async importFile(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xu(e);return l=_("{file_search_store_name}:importFile",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Nu(c),f=new yt;return Object.assign(f,d),f})}}}let Oo=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return Oo=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^n()&15>>+o/4).toString(16))};const Fd=()=>Oo();function dt(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const ct=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class K extends Error{}class B extends K{constructor(e,n,o,s){super(`${B.makeMessage(e,n,o)}`),this.status=e,this.headers=s,this.error=n}static makeMessage(e,n,o){const s=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):o;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,o,s){if(!e||!s)return new We({message:o,cause:ct(n)});const l=n;return e===400?new Qo(e,l,o,s):e===401?new Zo(e,l,o,s):e===403?new jo(e,l,o,s):e===404?new ei(e,l,o,s):e===409?new ti(e,l,o,s):e===422?new ni(e,l,o,s):e===429?new oi(e,l,o,s):e>=500?new ii(e,l,o,s):new B(e,l,o,s)}}class ft extends B{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class We extends B{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Xo extends We{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Qo extends B{}class Zo extends B{}class jo extends B{}class ei extends B{}class ti extends B{}class ni extends B{}class oi extends B{}class ii extends B{}const Gd=/^[a-z][a-z0-9+.-]*:/i,Vd=t=>Gd.test(t);let pt=t=>(pt=Array.isArray,pt(t));const Hd=pt;let bd=Hd;const fo=bd;function qd(t){if(!t)return!0;for(const e in t)return!1;return!0}function Bd(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Jd=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new K(`${t} must be an integer`);if(e<0)throw new K(`${t} must be a positive integer`);return e},$d=t=>{try{return JSON.parse(t)}catch{return}};const Yd=t=>new Promise(e=>setTimeout(e,t));const de="0.0.1";function Wd(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Kd=()=>{var t,e,n,o,s;const l=Wd();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":de,"X-Stainless-OS":ho(Deno.build.os),"X-Stainless-Arch":po(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":de,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":de,"X-Stainless-OS":ho((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":po((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const a=zd();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":de,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":de,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function zd(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const o=n.exec(navigator.userAgent);if(o){const s=o[1]||0,l=o[2]||0,a=o[3]||0;return{browser:e,version:`${s}.${l}.${a}`}}}return null}const po=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",ho=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Pe;const Od=()=>Pe??(Pe=Kd());function Xd(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function si(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Qd(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return si({start(){},async pull(n){const{done:o,value:s}=await e.next();o?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function ri(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Zd(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const o=t.getReader(),s=o.cancel();o.releaseLock(),await s}const jd=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const li=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e?.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function je(t,e,n){return li(),new File(t,e??"unknown_file",n)}function ec(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const tc=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";const ai=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",nc=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&ai(t),oc=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function ic(t,e,n){if(li(),t=await t,nc(t))return t instanceof File?t:je([await t.arrayBuffer()],t.name);if(oc(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),je(await ht(s),e,n)}const o=await ht(t);if(e||(e=ec(t)),!n?.type){const s=o.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof s=="string"&&(n=Object.assign(Object.assign({},n),{type:s}))}return je(o,e,n)}async function ht(t){var e,n,o,s,l;let a=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)a.push(t);else if(ai(t))a.push(t instanceof Blob?t:await t.arrayBuffer());else if(tc(t))try{for(var u=!0,c=O(t),d;d=await c.next(),e=d.done,!e;u=!0){s=d.value,u=!1;const f=s;a.push(...await ht(f))}}catch(f){n={error:f}}finally{try{!u&&!e&&(o=c.return)&&await o.call(c)}finally{if(n)throw n.error}}else{const f=(l=t?.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${sc(t)}`)}return a}function sc(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class ui{constructor(e){this._client=e}}ui._key=[];function di(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const mo=Object.freeze(Object.create(null)),rc=(t=di)=>(function(n,...o){if(n.length===1)return n[0];let s=!1;const l=[],a=n.reduce((f,h,p)=>{var m,v,y;/[?#]/.test(h)&&(s=!0);const g=o[p];let T=(s?encodeURIComponent:t)(""+g);return p!==o.length&&(g==null||typeof g=="object"&&g.toString===((y=Object.getPrototypeOf((v=Object.getPrototypeOf((m=g.hasOwnProperty)!==null&&m!==void 0?m:mo))!==null&&v!==void 0?v:mo))===null||y===void 0?void 0:y.toString))&&(T=g+"",l.push({start:f.length+h.length,length:T.length,error:`Value of type ${Object.prototype.toString.call(g).slice(8,-1)} is not a valid path parameter`})),f+h+(p===o.length?"":T)},""),u=a.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=c.exec(u))!==null;)l.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(l.sort((f,h)=>f.start-h.start),l.length>0){let f=0;const h=l.reduce((p,m)=>{const v=" ".repeat(m.start-f),y="^".repeat(m.length);return f=m.start+m.length,p+v+y},"");throw new K(`Path parameters result in path with invalid segments:
${l.map(p=>p.error).join(`
`)}
${a}
${h}`)}return a}),Ne=rc(di);class ci extends ui{create(e,n){var o;const{api_version:s=this._client.apiVersion}=e,l=He(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new K("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new K("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Ne`/${s}/interactions`,Object.assign(Object.assign({body:l},n),{stream:(o=e.stream)!==null&&o!==void 0?o:!1}))}delete(e,n={},o){const{api_version:s=this._client.apiVersion}=n??{};return this._client.delete(Ne`/${s}/interactions/${e}`,o)}cancel(e,n={},o){const{api_version:s=this._client.apiVersion}=n??{};return this._client.post(Ne`/${s}/interactions/${e}/cancel`,o)}get(e,n={},o){var s;const l=n??{},{api_version:a=this._client.apiVersion}=l,u=He(l,["api_version"]);return this._client.get(Ne`/${a}/interactions/${e}`,Object.assign(Object.assign({query:u},o),{stream:(s=n?.stream)!==null&&s!==void 0?s:!1}))}}ci._key=Object.freeze(["interactions"]);class fi extends ci{}function lc(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let o=0;for(const s of t)n.set(s,o),o+=s.length;return n}let xe;function At(t){let e;return(xe??(e=new globalThis.TextEncoder,xe=e.encode.bind(e)))(t)}let De;function go(t){let e;return(De??(e=new globalThis.TextDecoder,De=e.decode.bind(e)))(t)}class Ke{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?At(e):e;this.buffer=lc([this.buffer,n]);const o=[];let s;for(;(s=ac(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){o.push(go(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,a=go(this.buffer.subarray(0,l));o.push(a),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}Ke.NEWLINE_CHARS=new Set([`
`,"\r"]);Ke.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ac(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function uc(t){for(let o=0;o<t.length-1;o++){if(t[o]===10&&t[o+1]===10||t[o]===13&&t[o+1]===13)return o+2;if(t[o]===13&&t[o+1]===10&&o+3<t.length&&t[o+2]===13&&t[o+3]===10)return o+4}return-1}const be={off:0,error:200,warn:300,info:400,debug:500},vo=(t,e,n)=>{if(t){if(Bd(be,t))return t;b(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(be))}`)}};function Ce(){}function Ue(t,e,n){return!e||be[t]>be[n]?Ce:e[t].bind(e)}const dc={error:Ce,warn:Ce,info:Ce,debug:Ce};let yo=new WeakMap;function b(t){var e;const n=t.logger,o=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return dc;const s=yo.get(n);if(s&&s[0]===o)return s[1];const l={error:Ue("error",n,o),warn:Ue("warn",n,o),info:Ue("info",n,o),debug:Ue("debug",n,o)};return yo.set(n,[o,l]),l}const se=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);class fe{constructor(e,n,o){this.iterator=e,this.controller=n,this.client=o}static fromSSEResponse(e,n,o){let s=!1;const l=o?b(o):console;function a(){return z(this,arguments,function*(){var c,d,f,h;if(s)throw new K("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let p=!1;try{try{for(var m=!0,v=O(cc(e,n)),y;y=yield M(v.next()),c=y.done,!c;m=!0){h=y.value,m=!1;const g=h;if(!p)if(g.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield M(JSON.parse(g.data))}catch(T){throw l.error("Could not parse message into JSON:",g.data),l.error("From chunk:",g.raw),T}}}catch(g){d={error:g}}finally{try{!m&&!c&&(f=v.return)&&(yield M(f.call(v)))}finally{if(d)throw d.error}}p=!0}catch(g){if(dt(g))return yield M(void 0);throw g}finally{p||n.abort()}})}return new fe(a,n,o)}static fromReadableStream(e,n,o){let s=!1;function l(){return z(this,arguments,function*(){var c,d,f,h;const p=new Ke,m=ri(e);try{for(var v=!0,y=O(m),g;g=yield M(y.next()),c=g.done,!c;v=!0){h=g.value,v=!1;const T=h;for(const C of p.decode(T))yield yield M(C)}}catch(T){d={error:T}}finally{try{!v&&!c&&(f=y.return)&&(yield M(f.call(y)))}finally{if(d)throw d.error}}for(const T of p.flush())yield yield M(T)})}function a(){return z(this,arguments,function*(){var c,d,f,h;if(s)throw new K("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let p=!1;try{try{for(var m=!0,v=O(l()),y;y=yield M(v.next()),c=y.done,!c;m=!0){h=y.value,m=!1;const g=h;p||g&&(yield yield M(JSON.parse(g)))}}catch(g){d={error:g}}finally{try{!m&&!c&&(f=v.return)&&(yield M(f.call(v)))}finally{if(d)throw d.error}}p=!0}catch(g){if(dt(g))return yield M(void 0);throw g}finally{p||n.abort()}})}return new fe(a,n,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],o=this.iterator(),s=l=>({next:()=>{if(l.length===0){const a=o.next();e.push(a),n.push(a)}return l.shift()}});return[new fe(()=>s(e),this.controller,this.client),new fe(()=>s(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return si({async start(){n=e[Symbol.asyncIterator]()},async pull(o){try{const{value:s,done:l}=await n.next();if(l)return o.close();const a=At(JSON.stringify(s)+`
`);o.enqueue(a)}catch(s){o.error(s)}},async cancel(){var o;await((o=n.return)===null||o===void 0?void 0:o.call(n))}})}}function cc(t,e){return z(this,arguments,function*(){var o,s,l,a;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new K("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new K("Attempted to iterate over a response with no body");const u=new pc,c=new Ke,d=ri(t.body);try{for(var f=!0,h=O(fc(d)),p;p=yield M(h.next()),o=p.done,!o;f=!0){a=p.value,f=!1;const m=a;for(const v of c.decode(m)){const y=u.decode(v);y&&(yield yield M(y))}}}catch(m){s={error:m}}finally{try{!f&&!o&&(l=h.return)&&(yield M(l.call(h)))}finally{if(s)throw s.error}}for(const m of c.flush()){const v=u.decode(m);v&&(yield yield M(v))}})}function fc(t){return z(this,arguments,function*(){var n,o,s,l;let a=new Uint8Array;try{for(var u=!0,c=O(t),d;d=yield M(c.next()),n=d.done,!n;u=!0){l=d.value,u=!1;const f=l;if(f==null)continue;const h=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?At(f):f;let p=new Uint8Array(a.length+h.length);p.set(a),p.set(h,a.length),a=p;let m;for(;(m=uc(a))!==-1;)yield yield M(a.slice(0,m)),a=a.slice(m)}}catch(f){o={error:f}}finally{try{!u&&!n&&(s=c.return)&&(yield M(s.call(c)))}finally{if(o)throw o.error}}a.length>0&&(yield yield M(a))})}class pc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,o,s]=hc(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function hc(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function mc(t,e){const{response:n,requestLogID:o,retryOfRequestLogID:s,startTime:l}=e,a=await(async()=>{var u;if(e.options.stream)return b(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):fe.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(u=c?.split(";")[0])===null||u===void 0?void 0:u.trim();return d?.includes("application/json")||d?.endsWith("+json")?await n.json():await n.text()})();return b(t).debug(`[${o}] response parsed`,se({retryOfRequestLogID:s,url:n.url,status:n.status,body:a,durationMs:Date.now()-l})),a}class Rt extends Promise{constructor(e,n,o=mc){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=o,this.client=e}_thenUnwrap(e){return new Rt(this.client,this.responsePromise,async(n,o)=>e(await this.parseResponse(n,o),o))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const pi=Symbol("brand.privateNullableHeaders");function*gc(t){if(!t)return;if(pi in t){const{values:o,nulls:s}=t;yield*o.entries();for(const l of s)yield[l,null];return}let e=!1,n;t instanceof Headers?n=t.entries():fo(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let o of n){const s=o[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const l=fo(o[1])?o[1]:[o[1]];let a=!1;for(const u of l)u!==void 0&&(e&&!a&&(a=!0,yield[s,null]),yield[s,u])}}const Ee=t=>{const e=new Headers,n=new Set;for(const o of t){const s=new Set;for(const[l,a]of gc(o)){const u=l.toLowerCase();s.has(u)||(e.delete(l),s.add(u)),a===null?(e.delete(l),n.add(u)):(e.append(l,a),n.delete(u))}}return{[pi]:!0,values:e,nulls:n}};const et=t=>{var e,n,o,s,l,a;if(typeof globalThis.process<"u")return(o=(n=(e=qi)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(a=(l=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||l===void 0?void 0:l.call(s,t))===null||a===void 0?void 0:a.trim()};var hi;class ze{constructor(e){var n,o,s,l,a,u,c,{baseURL:d=et("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=et("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:h="v1beta"}=e,p=He(e,["baseURL","apiKey","apiVersion"]);const m=Object.assign(Object.assign({apiKey:f,apiVersion:h},p),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=m.baseURL,this.timeout=(o=m.timeout)!==null&&o!==void 0?o:ze.DEFAULT_TIMEOUT,this.logger=(s=m.logger)!==null&&s!==void 0?s:console;const v="warn";this.logLevel=v,this.logLevel=(a=(l=vo(m.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:vo(et("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:v,this.fetchOptions=m.fetchOptions,this.maxRetries=(u=m.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(c=m.fetch)!==null&&c!==void 0?c:Xd(),this.encoder=jd,this._options=m,this.apiKey=f,this.apiVersion=h,this.clientAdapter=m.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=Ee([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return Ee([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Ee([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,o])=>typeof o<"u").map(([n,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(n)}=`;throw new K(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${de}`}defaultIdempotencyKey(){return`stainless-node-retry-${Fd()}`}makeStatusError(e,n,o,s){return B.generate(e,n,o,s)}buildURL(e,n,o){const s=!this.baseURLOverridden()&&o||this.baseURL,l=Vd(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return qd(a)||(n=Object.assign(Object.assign({},a),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(l.search=this.stringifyQuery(n)),l.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:o}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,o){return this.request(Promise.resolve(o).then(s=>Object.assign({method:e,path:n},s)))}request(e,n=null){return new Rt(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,o){var s,l,a;const u=await e,c=(s=u.maxRetries)!==null&&s!==void 0?s:this.maxRetries;n==null&&(n=c),await this.prepareOptions(u);const{req:d,url:f,timeout:h}=await this.buildRequest(u,{retryCount:c-n});await this.prepareRequest(d,{url:f,options:u});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=o===void 0?"":`, retryOf: ${o}`,v=Date.now();if(b(this).debug(`[${p}] sending request`,se({retryOfRequestLogID:o,method:u.method,url:f,options:u,headers:d.headers})),!((l=u.signal)===null||l===void 0)&&l.aborted)throw new ft;const y=new AbortController,g=await this.fetchWithTimeout(f,d,h,y).catch(ct),T=Date.now();if(g instanceof globalThis.Error){const E=`retrying, ${n} attempts remaining`;if(!((a=u.signal)===null||a===void 0)&&a.aborted)throw new ft;const I=dt(g)||/timed? ?out/i.test(String(g)+("cause"in g?String(g.cause):""));if(n)return b(this).info(`[${p}] connection ${I?"timed out":"failed"} - ${E}`),b(this).debug(`[${p}] connection ${I?"timed out":"failed"} (${E})`,se({retryOfRequestLogID:o,url:f,durationMs:T-v,message:g.message})),this.retryRequest(u,n,o??p);throw b(this).info(`[${p}] connection ${I?"timed out":"failed"} - error; no more retries left`),b(this).debug(`[${p}] connection ${I?"timed out":"failed"} (error; no more retries left)`,se({retryOfRequestLogID:o,url:f,durationMs:T-v,message:g.message})),I?new Xo:new We({cause:g})}const C=`[${p}${m}] ${d.method} ${f} ${g.ok?"succeeded":"failed"} with status ${g.status} in ${T-v}ms`;if(!g.ok){const E=await this.shouldRetry(g);if(n&&E){const A=`retrying, ${n} attempts remaining`;return await Zd(g.body),b(this).info(`${C} - ${A}`),b(this).debug(`[${p}] response error (${A})`,se({retryOfRequestLogID:o,url:g.url,status:g.status,headers:g.headers,durationMs:T-v})),this.retryRequest(u,n,o??p,g.headers)}const I=E?"error; no more retries left":"error; not retryable";b(this).info(`${C} - ${I}`);const S=await g.text().catch(A=>ct(A).message),R=$d(S),w=R?void 0:S;throw b(this).debug(`[${p}] response error (${I})`,se({retryOfRequestLogID:o,url:g.url,status:g.status,headers:g.headers,message:w,durationMs:Date.now()-v})),this.makeStatusError(g.status,R,w,g.headers)}return b(this).info(C),b(this).debug(`[${p}] response start`,se({retryOfRequestLogID:o,url:g.url,status:g.status,headers:g.headers,durationMs:T-v})),{response:g,options:u,controller:y,requestLogID:p,retryOfRequestLogID:o,startTime:v}}async fetchWithTimeout(e,n,o,s){const l=n||{},{signal:a,method:u}=l,c=He(l,["signal","method"]);a&&a.addEventListener("abort",()=>s.abort());const d=setTimeout(()=>s.abort(),o),f=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,h=Object.assign(Object.assign(Object.assign({signal:s.signal},f?{duplex:"half"}:{}),{method:"GET"}),c);u&&(h.method=u.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,o,s){var l;let a;const u=s?.get("retry-after-ms");if(u){const d=parseFloat(u);Number.isNaN(d)||(a=d)}const c=s?.get("retry-after");if(c&&!a){const d=parseFloat(c);Number.isNaN(d)?a=Date.parse(c)-Date.now():a=d*1e3}if(!(a&&0<=a&&a<60*1e3)){const d=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,d)}return await Yd(a),this.makeRequest(e,n-1,o)}calculateDefaultRetryTimeoutMillis(e,n){const l=n-e,a=Math.min(.5*Math.pow(2,l),8),u=1-Math.random()*.25;return a*u*1e3}async buildRequest(e,{retryCount:n=0}={}){var o,s,l;const a=Object.assign({},e),{method:u,path:c,query:d,defaultBaseURL:f}=a,h=this.buildURL(c,d,f);"timeout"in a&&Jd("timeout",a.timeout),a.timeout=(o=a.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:p,body:m}=this.buildBody({options:a}),v=await this.buildHeaders({options:e,method:u,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:v},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(l=a.fetchOptions)!==null&&l!==void 0?l:{}),url:h,timeout:a.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:o,retryCount:s}){let l={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const a=await this.authHeaders(e);let u=Ee([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Od()),this._options.defaultHeaders,o,e.headers,a]);return this.validateHeaders(u),u.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const o=Ee([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&o.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Qd(e)}:this.encoder({body:e,headers:o})}}ze.DEFAULT_TIMEOUT=6e4;class F extends ze{constructor(){super(...arguments),this.interactions=new fi(this)}}hi=F;F.GeminiNextGenAPIClient=hi;F.GeminiNextGenAPIClientError=K;F.APIError=B;F.APIConnectionError=We;F.APIConnectionTimeoutError=Xo;F.APIUserAbortError=ft;F.NotFoundError=ei;F.ConflictError=ti;F.RateLimitError=oi;F.BadRequestError=Qo;F.AuthenticationError=Zo;F.InternalServerError=ii;F.PermissionDeniedError=jo;F.UnprocessableEntityError=ni;F.toFile=ic;F.Interactions=fi;function vc(t,e){const n={},o=i(t,["name"]);return o!=null&&r(n,["_url","name"],o),n}function yc(t,e){const n={},o=i(t,["name"]);return o!=null&&r(n,["_url","name"],o),n}function Tc(t,e){const n={},o=i(t,["sdkHttpResponse"]);return o!=null&&r(n,["sdkHttpResponse"],o),n}function _c(t,e){const n={},o=i(t,["sdkHttpResponse"]);return o!=null&&r(n,["sdkHttpResponse"],o),n}function Ec(t,e,n){const o={};if(i(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=i(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&r(e,["displayName"],s),i(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=i(t,["epochCount"]);e!==void 0&&l!=null&&r(e,["tuningTask","hyperparameters","epochCount"],l);const a=i(t,["learningRateMultiplier"]);if(a!=null&&r(o,["tuningTask","hyperparameters","learningRateMultiplier"],a),i(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(i(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(i(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=i(t,["batchSize"]);e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","batchSize"],u);const c=i(t,["learningRate"]);if(e!==void 0&&c!=null&&r(e,["tuningTask","hyperparameters","learningRate"],c),i(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(i(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function Cc(t,e,n){const o={};let s=i(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const m=i(t,["validationDataset"]);e!==void 0&&m!=null&&r(e,["supervisedTuningSpec"],To(m))}else if(s==="PREFERENCE_TUNING"){const m=i(t,["validationDataset"]);e!==void 0&&m!=null&&r(e,["preferenceOptimizationSpec"],To(m))}const l=i(t,["tunedModelDisplayName"]);e!==void 0&&l!=null&&r(e,["tunedModelDisplayName"],l);const a=i(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);let u=i(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=i(t,["epochCount"]);e!==void 0&&m!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(u==="PREFERENCE_TUNING"){const m=i(t,["epochCount"]);e!==void 0&&m!=null&&r(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let c=i(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const m=i(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(c==="PREFERENCE_TUNING"){const m=i(t,["learningRateMultiplier"]);e!==void 0&&m!=null&&r(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let d=i(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=i(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&r(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(d==="PREFERENCE_TUNING"){const m=i(t,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&r(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let f=i(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const m=i(t,["adapterSize"]);e!==void 0&&m!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(f==="PREFERENCE_TUNING"){const m=i(t,["adapterSize"]);e!==void 0&&m!=null&&r(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(i(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(i(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=i(t,["labels"]);e!==void 0&&h!=null&&r(e,["labels"],h);const p=i(t,["beta"]);return e!==void 0&&p!=null&&r(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),o}function Sc(t,e){const n={},o=i(t,["baseModel"]);o!=null&&r(n,["baseModel"],o);const s=i(t,["preTunedModel"]);s!=null&&r(n,["preTunedModel"],s);const l=i(t,["trainingDataset"]);l!=null&&kc(l);const a=i(t,["config"]);return a!=null&&Ec(a,n),n}function Ic(t,e){const n={},o=i(t,["baseModel"]);o!=null&&r(n,["baseModel"],o);const s=i(t,["preTunedModel"]);s!=null&&r(n,["preTunedModel"],s);const l=i(t,["trainingDataset"]);l!=null&&Lc(l,n,e);const a=i(t,["config"]);return a!=null&&Cc(a,n,e),n}function Ac(t,e){const n={},o=i(t,["name"]);return o!=null&&r(n,["_url","name"],o),n}function Rc(t,e){const n={},o=i(t,["name"]);return o!=null&&r(n,["_url","name"],o),n}function wc(t,e,n){const o={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),o}function Mc(t,e,n){const o={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),o}function Pc(t,e){const n={},o=i(t,["config"]);return o!=null&&wc(o,n),n}function Nc(t,e){const n={},o=i(t,["config"]);return o!=null&&Mc(o,n),n}function xc(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&r(n,["sdkHttpResponse"],o);const s=i(t,["nextPageToken"]);s!=null&&r(n,["nextPageToken"],s);const l=i(t,["tunedModels"]);if(l!=null){let a=l;Array.isArray(a)&&(a=a.map(u=>mi(u))),r(n,["tuningJobs"],a)}return n}function Dc(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&r(n,["sdkHttpResponse"],o);const s=i(t,["nextPageToken"]);s!=null&&r(n,["nextPageToken"],s);const l=i(t,["tuningJobs"]);if(l!=null){let a=l;Array.isArray(a)&&(a=a.map(u=>mt(u))),r(n,["tuningJobs"],a)}return n}function Uc(t,e){const n={},o=i(t,["name"]);o!=null&&r(n,["model"],o);const s=i(t,["name"]);return s!=null&&r(n,["endpoint"],s),n}function kc(t,e){const n={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=i(t,["examples"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>l)),r(n,["examples","examples"],s)}return n}function Lc(t,e,n){const o={};let s=i(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const a=i(t,["gcsUri"]);e!==void 0&&a!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(s==="PREFERENCE_TUNING"){const a=i(t,["gcsUri"]);e!==void 0&&a!=null&&r(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let l=i(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const a=i(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(l==="PREFERENCE_TUNING"){const a=i(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&r(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(i(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function mi(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&r(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&r(n,["name"],s);const l=i(t,["state"]);l!=null&&r(n,["state"],xo(l));const a=i(t,["createTime"]);a!=null&&r(n,["createTime"],a);const u=i(t,["tuningTask","startTime"]);u!=null&&r(n,["startTime"],u);const c=i(t,["tuningTask","completeTime"]);c!=null&&r(n,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&r(n,["updateTime"],d);const f=i(t,["description"]);f!=null&&r(n,["description"],f);const h=i(t,["baseModel"]);h!=null&&r(n,["baseModel"],h);const p=i(t,["_self"]);return p!=null&&r(n,["tunedModel"],Uc(p)),n}function mt(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&r(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&r(n,["name"],s);const l=i(t,["state"]);l!=null&&r(n,["state"],xo(l));const a=i(t,["createTime"]);a!=null&&r(n,["createTime"],a);const u=i(t,["startTime"]);u!=null&&r(n,["startTime"],u);const c=i(t,["endTime"]);c!=null&&r(n,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&r(n,["updateTime"],d);const f=i(t,["error"]);f!=null&&r(n,["error"],f);const h=i(t,["description"]);h!=null&&r(n,["description"],h);const p=i(t,["baseModel"]);p!=null&&r(n,["baseModel"],p);const m=i(t,["tunedModel"]);m!=null&&r(n,["tunedModel"],m);const v=i(t,["preTunedModel"]);v!=null&&r(n,["preTunedModel"],v);const y=i(t,["supervisedTuningSpec"]);y!=null&&r(n,["supervisedTuningSpec"],y);const g=i(t,["preferenceOptimizationSpec"]);g!=null&&r(n,["preferenceOptimizationSpec"],g);const T=i(t,["tuningDataStats"]);T!=null&&r(n,["tuningDataStats"],T);const C=i(t,["encryptionSpec"]);C!=null&&r(n,["encryptionSpec"],C);const E=i(t,["partnerModelTuningSpec"]);E!=null&&r(n,["partnerModelTuningSpec"],E);const I=i(t,["customBaseModel"]);I!=null&&r(n,["customBaseModel"],I);const S=i(t,["experiment"]);S!=null&&r(n,["experiment"],S);const R=i(t,["labels"]);R!=null&&r(n,["labels"],R);const w=i(t,["outputUri"]);w!=null&&r(n,["outputUri"],w);const x=i(t,["pipelineJob"]);x!=null&&r(n,["pipelineJob"],x);const A=i(t,["serviceAccount"]);A!=null&&r(n,["serviceAccount"],A);const P=i(t,["tunedModelDisplayName"]);P!=null&&r(n,["tunedModelDisplayName"],P);const U=i(t,["veoTuningSpec"]);return U!=null&&r(n,["veoTuningSpec"],U),n}function Fc(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&r(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&r(n,["name"],s);const l=i(t,["metadata"]);l!=null&&r(n,["metadata"],l);const a=i(t,["done"]);a!=null&&r(n,["done"],a);const u=i(t,["error"]);return u!=null&&r(n,["error"],u),n}function To(t,e){const n={},o=i(t,["gcsUri"]);o!=null&&r(n,["validationDatasetUri"],o);const s=i(t,["vertexDatasetResource"]);return s!=null&&r(n,["validationDatasetUri"],s),n}class Gc extends ee{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new re(j.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var o;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const s={tunedModelName:n.baseModel};!((o=n.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(s.checkpointId=n.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},n),{preTunedModel:s});return l.baseModel=void 0,await this.tuneInternal(l)}else{const s=Object.assign({},n);return await this.tuneInternal(s)}else{const s=Object.assign({},n),l=await this.tuneMldevInternal(s);let a="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?a=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(a=l.name.split("/operations/")[0]),{name:a,state:ot.JOB_STATE_QUEUED}}}}async getInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Rc(e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>mt(f))}else{const d=Ac(e);return u=_("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>mi(f))}}async listInternal(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Nc(e);return u=_("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Dc(f),p=new $n;return Object.assign(p,h),p})}else{const d=Pc(e);return u=_("tunedModels",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=xc(f),p=new $n;return Object.assign(p,h),p})}}async cancel(e){var n,o,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=yc(e);return u=_("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=_c(f),p=new Yn;return Object.assign(p,h),p})}else{const d=vc(e);return u=_("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const h=Tc(f),p=new Yn;return Object.assign(p,h),p})}}async tuneInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Ic(e,e);return l=_("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>mt(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,o;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Sc(e);return l=_("tunedModels",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>Fc(c))}}}class Vc{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Hc=1024*1024*8,bc=3,qc=1e3,Bc=2,qe="x-goog-upload-status";async function Jc(t,e,n){var o;const s=await gi(t,e,n),l=await s?.json();if(((o=s?.headers)===null||o===void 0?void 0:o[qe])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return l.file}async function $c(t,e,n){var o;const s=await gi(t,e,n),l=await s?.json();if(((o=s?.headers)===null||o===void 0?void 0:o[qe])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=Ao(l),u=new Tt;return Object.assign(u,a),u}async function gi(t,e,n){var o,s;let l=0,a=0,u=new it(new Response),c="upload";for(l=t.size;a<l;){const d=Math.min(Hc,l-a),f=t.slice(a,a+d);a+d>=l&&(c+=", finalize");let h=0,p=qc;for(;h<bc&&(u=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(d)}}}),!(!((o=u?.headers)===null||o===void 0)&&o[qe]));)h++,await Wc(p),p=p*Bc;if(a+=d,((s=u?.headers)===null||s===void 0?void 0:s[qe])!=="active")break;if(l<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function Yc(t){return{size:t.size,type:t.type}}function Wc(t){return new Promise(e=>setTimeout(e,t))}class Kc{async upload(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Jc(e,n,o)}async uploadToFileSearchStore(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await $c(e,n,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Yc(e)}}class zc{create(e,n,o){return new Oc(e,n,o)}}class Oc{constructor(e,n,o){this.url=e,this.headers=n,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const _o="x-goog-api-key";class Xc{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(_o)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(_o,this.apiKey)}}}const Qc="gl-node/";class Zc{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new F({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const o=Yi(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new Xc(this.apiKey);this.apiClient=new Yu({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Qc+"web",uploader:new Kc,downloader:new Vc}),this.models=new dd(this.apiClient),this.live=new id(this.apiClient,s,new zc),this.batches=new _r(this.apiClient),this.chats=new tl(this.models,this.apiClient),this.caches=new Zr(this.apiClient),this.files=new cl(this.apiClient),this.operations=new cd(this.apiClient),this.authTokens=new wd(this.apiClient),this.tunings=new Gc(this.apiClient),this.fileSearchStores=new Ld(this.apiClient)}}const jc="your_api_key_here",ef=16e3,Eo=24e3,tf={coffee_shop:"We are meeting for a casual coffee. Ambient noise is moderate.",restaurant:"We are at a nice dinner date. The atmosphere is intimate.",video_call:"We are on a Facetime/Zoom call. It is a first remote date."},nf={male:"You are a friendly, slightly nervous but charming guy named Alex.",female:"You are a confident, warm, and engaging woman named Sarah.",discord_kitten:"You are a playful, internet-savvy, slightly chaotic personality using internet slang."};function of(t){const e=t.length,n=new Int16Array(e);for(let u=0;u<e;u++)n[u]=t[u]*32768;let o="";const s=new Uint8Array(n.buffer),l=s.byteLength;for(let u=0;u<l;u++)o+=String.fromCharCode(s[u]);return{data:btoa(o),mimeType:"audio/pcm;rate=16000"}}function sf(t){const e=atob(t),n=e.length,o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=e.charCodeAt(s);return o}async function rf(t,e,n,o){const s=new Int16Array(t.buffer),l=s.length/o,a=e.createBuffer(o,l,n);for(let u=0;u<o;u++){const c=a.getChannelData(u);for(let d=0;d<l;d++)c[d]=s[d*o+u]/32768}return a}async function lf(t){return new Promise((e,n)=>{const o=new FileReader;o.onloadend=()=>{const s=o.result;e(s.split(",")[1])},o.onerror=n,o.readAsDataURL(t)})}class af{ai;inputAudioContext=null;outputAudioContext=null;inputNode=null;sourceNode=null;outputNode=null;nextStartTime=0;sources=new Set;sessionPromise=null;videoInterval=null;audioStream=null;constructor(){this.ai=new Zc({apiKey:jc})}async connect(e,n,o,s,l){if(this.inputAudioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:ef}),this.outputAudioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:Eo}),!this.outputAudioContext)throw new Error("Audio Context not supported");this.outputNode=this.outputAudioContext.createGain(),this.outputNode.connect(this.outputAudioContext.destination),this.audioStream=await navigator.mediaDevices.getUserMedia({audio:!0});const a=`
      ${nf[n]}
      Context: ${tf[e]}
      Role: You are a date preparation mentor for a neurodivergent user.
      Your goal is to have a natural conversation.
      Be supportive but realistic.
      Do not be overly robotic.
      If the user is silent for too long, gently prompt them.
      Keep your responses relatively concise (under 20 seconds) to allow for back-and-forth.
    `;this.sessionPromise=this.ai.live.connect({model:"gemini-2.5-flash-native-audio-preview-12-2025",config:{responseModalities:[Se.AUDIO],systemInstruction:a,speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:n==="male"?"Puck":"Kore"}}},inputAudioTranscription:{},outputAudioTranscription:{}},callbacks:{onopen:()=>{console.log("Gemini Live Session Opened"),this.audioStream&&this.startAudioInput(this.audioStream),this.startVideoInput(o)},onmessage:async u=>{u.serverContent?.inputTranscription?.text&&s("user",u.serverContent.inputTranscription.text),u.serverContent?.outputTranscription?.text&&s("ai",u.serverContent.outputTranscription.text);const c=u.serverContent?.modelTurn?.parts?.[0]?.inlineData?.data;if(c&&this.outputAudioContext&&this.outputNode){this.nextStartTime=Math.max(this.nextStartTime,this.outputAudioContext.currentTime);const d=await rf(sf(c),this.outputAudioContext,Eo,1),f=this.outputAudioContext.createBufferSource();f.buffer=d,f.connect(this.outputNode),f.addEventListener("ended",()=>{this.sources.delete(f)}),f.start(this.nextStartTime),this.nextStartTime+=d.duration,this.sources.add(f)}u.serverContent?.interrupted&&(this.sources.forEach(d=>{try{d.stop()}catch{}}),this.sources.clear(),this.nextStartTime=0)},onclose:()=>{console.log("Session closed"),l()},onerror:u=>{console.error("Session error",u),l()}}}),await this.sessionPromise}startAudioInput(e){this.inputAudioContext&&(this.sourceNode=this.inputAudioContext.createMediaStreamSource(e),this.inputNode=this.inputAudioContext.createScriptProcessor(4096,1,1),this.inputNode.onaudioprocess=n=>{const o=n.inputBuffer.getChannelData(0),s=of(o);this.sessionPromise?.then(l=>{l.sendRealtimeInput({media:s})})},this.sourceNode.connect(this.inputNode),this.inputNode.connect(this.inputAudioContext.destination))}startVideoInput(e){const n=document.createElement("canvas"),o=n.getContext("2d"),s=1;this.videoInterval=window.setInterval(()=>{!o||e.paused||e.ended||(n.width=e.videoWidth/4,n.height=e.videoHeight/4,o.drawImage(e,0,0,n.width,n.height),n.toBlob(async l=>{if(l){const a=await lf(l);this.sessionPromise?.then(u=>{u.sendRealtimeInput({media:{mimeType:"image/jpeg",data:a}})})}},"image/jpeg",.6))},1e3/s)}async disconnect(){if(this.videoInterval&&clearInterval(this.videoInterval),this.sourceNode)try{this.sourceNode.disconnect()}catch{}if(this.inputNode)try{this.inputNode.disconnect()}catch{}if(this.audioStream&&(this.audioStream.getTracks().forEach(e=>e.stop()),this.audioStream=null),this.inputAudioContext&&this.inputAudioContext.state!=="closed")try{await this.inputAudioContext.close()}catch{}if(this.outputAudioContext&&this.outputAudioContext.state!=="closed")try{await this.outputAudioContext.close()}catch{}this.sources.forEach(e=>{try{e.stop()}catch{}}),this.sources.clear()}}var uf=me('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg>'),df=me('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="2" x2="22" y1="2" y2="22"></line><path d="M18.89 13.23A7.12 7.12 0 0 0 19 12v-2"></path><path d="M5 10v2a7 7 0 0 0 12 5"></path><path d="M15 9.34V5a3 3 0 0 0-5.68-1.33"></path><path d="M9 9v3a3 3 0 0 0 5.12 2.12"></path><line x1="12" x2="12" y1="19" y2="22"></line></svg>'),cf=Ie('<div class="z-20 flex items-center justify-center gap-6 border-t border-white/10 bg-black/80 p-6 backdrop-blur-md"><button type="button"><!></button> <div class="mx-2 h-12 w-[1px] bg-white/10"></div> <div class="max-w-[150px] text-center text-xs text-slate-400"><!></div> <div class="mx-2 h-12 w-[1px] bg-white/10"></div> <button type="button" class="flex items-center gap-2 rounded-full border border-red-500/30 bg-red-500/20 px-4 py-2 text-red-100 backdrop-blur-sm transition-all hover:bg-red-500/40"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"></path><line x1="22" x2="2" y1="2" y2="22"></line></svg> <span class="text-sm font-semibold">End Call</span></button></div>');function ff(t,e){Co(e,!0);let n=Vt(e,"micActive",15,!0),o=Vt(e,"isConnected",3,!1);function s(){n(!n())}var l=cf(),a=V(l);a.__click=s;var u=V(a);{var c=y=>{var g=uf();q(y,g)},d=y=>{var g=df();q(y,g)};ne(u,y=>{n()?y(c):y(d,!1)})}H(a);var f=Y(a,4),h=V(f);{var p=y=>{var g=Dt("AI is analyzing your tone and facial cues in real-time.");q(y,g)},m=y=>{var g=Dt("Connecting to AI...");q(y,g)};ne(h,y=>{o()?y(p):y(m,!1)})}H(f);var v=Y(f,4);v.__click=function(...y){e.onEndSession?.apply(this,y)},H(l),tt(()=>ke(a,1,`rounded-full p-4 transition-all ${n()?"bg-slate-700 text-white hover:bg-slate-600":"bg-red-500/20 text-red-400"}`)),q(t,l),So()}Io(["click"]);var pf=Ie('<div class="space-y-1"><div class="h-1 w-16 animate-pulse rounded-full bg-indigo-300" style="animation-delay: 0s"></div> <div class="mx-auto h-1 w-10 animate-pulse rounded-full bg-indigo-300" style="animation-delay: 0.2s"></div> <div class="h-1 w-14 animate-pulse rounded-full bg-indigo-300" style="animation-delay: 0.4s"></div></div>'),hf=me('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-slate-500"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>'),mf=Ie("<span>&#128572;</span>"),gf=me('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"></path><circle cx="12" cy="12" r="3"></circle></svg>'),vf=me('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>'),yf=me('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"></path></svg>'),Tf=Ie('<div><div class="flex items-center gap-3"><!> <span class="text-sm font-medium"> </span></div></div>'),_f=Ie('<div class="relative flex h-screen flex-col overflow-hidden bg-slate-900 text-white"><div class="absolute left-0 right-0 top-0 z-20 flex items-center justify-between bg-gradient-to-b from-black/50 to-transparent p-4"><div class="flex items-center gap-2"><span></span> <span class="text-sm font-medium uppercase tracking-wide opacity-80"> </span></div> <button type="button" class="flex items-center gap-2 rounded-full border border-red-500/30 bg-red-500/20 px-4 py-2 text-red-100 backdrop-blur-sm transition-all hover:bg-red-500/40"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91"></path><line x1="22" x2="2" y1="2" y2="22"></line></svg> <span class="text-sm font-semibold">End Call</span></button></div> <div class="relative flex flex-1 items-center justify-center"><video class="absolute inset-0 z-0 h-full w-full object-cover opacity-50" playsinline=""></video> <div class="relative z-10 flex flex-col items-center justify-center p-8 text-center"><div><!></div> <h2 class="mb-2 text-2xl font-light tracking-tight"> <!></h2> <p class="max-w-xs text-sm text-indigo-200/60"> </p></div> <!></div> <!></div>',2);function xf(t,e){Co(e,!0);let n=we(null),o=we(!1),s=we(!0),l=null,a=null,u=null;const c=Qe(Di);c||Gt("/lab");const d=c?Hi(c.persona):"",f=c?bi(c.scenario):"";function h(){const S=Qe(Fi),R=Qe(Ft)||Date.now(),w=Math.floor((Date.now()-R)/1e3),x=["You maintained a warm and inviting tone throughout the conversation.","Your pacing was excellent - not too fast, not too slow.","You asked thoughtful follow-up questions that showed genuine interest.","Your body language appeared open and engaged.","You handled pauses naturally without rushing to fill silence.","Your responses were well-structured and easy to follow."],A=["Try maintaining eye contact for slightly longer periods.","Consider taking a breath before responding to complex questions.","Practice active listening cues like nodding or brief verbal affirmations.","Work on varying your vocal tone to add more expressiveness.","Try to relax your shoulders during intense moments."],P=[...x].sort(()=>Math.random()-.5),U=[...A].sort(()=>Math.random()-.5);return{duration:w,strengths:P.slice(0,3),improvements:U.slice(0,2),transcript:S}}function p(){u=window.setInterval(()=>{if(!k(o))return;const S=Math.random();S>.95?Ze({timestamp:Date.now(),type:"eye_contact",message:"Gentle reminder: Try to look at the camera.",severity:"info"}):S>.9&&S<.92?Ze({timestamp:Date.now(),type:"pacing",message:"Great pacing! You are speaking clearly.",severity:"success"}):S<.05?Ze({timestamp:Date.now(),type:"posture",message:"Relax your shoulders, take a deep breath.",severity:"info"}):Math.random()>.7&&Ht()},4e3)}async function m(){if(!(!c||!k(n)))try{a=await navigator.mediaDevices.getUserMedia({video:!0}),k(n).srcObject=a,await k(n).play(),Ft.set(Date.now()),Ui(),l=new af,await l.connect(c.scenario,c.persona,k(n),(S,R)=>{ki(S,R)},()=>{v()}),Re(o,!0),p()}catch(S){console.error("Failed to init session:",S)}}function v(){const S=h();Li.set(S),Gt("/rewind")}function y(){u&&(clearInterval(u),u=null),a&&(a.getTracks().forEach(S=>S.stop()),a=null),l&&(l.disconnect(),l=null),Ht()}xi(()=>{c&&k(n)&&m()}),kt(()=>{y()});let g=we(null);const T=gt.subscribe(S=>{Re(g,S,!0)});kt(()=>{T()});var C=Ut(),E=Lt(C);{var I=S=>{var R=_f(),w=V(R),x=V(w),A=V(x),P=Y(A,2),U=V(P);H(P),H(x);var Q=Y(x,2);Q.__click=v,H(w);var D=Y(w,2),J=V(D);J.muted=!0,Gi(J,L=>Re(n,L),()=>k(n));var le=Y(J,2),$=V(le),Te=V($);{var vi=L=>{var Z=pf();q(L,Z)},yi=L=>{var Z=hf();q(L,Z)};ne(Te,L=>{k(o)?L(vi):L(yi,!1)})}H($);var Oe=Y($,2),wt=V(Oe),Ti=Y(wt);{var _i=L=>{var Z=mf();q(L,Z)};ne(Ti,L=>{c.persona==="discord_kitten"&&L(_i)})}H(Oe);var Mt=Y(Oe,2),Ei=V(Mt,!0);H(Mt),H(le);var Ci=Y(le,2);{var Si=L=>{var Z=Tf(),Pt=V(Z),Nt=V(Pt);{var Ai=ae=>{var Ae=gf();q(ae,Ae)},Ri=ae=>{var Ae=Ut(),Mi=Lt(Ae);{var Pi=ue=>{var Xe=vf();q(ue,Xe)},Ni=ue=>{var Xe=yf();q(ue,Xe)};ne(Mi,ue=>{k(g).type==="posture"?ue(Pi):ue(Ni,!1)},!0)}q(ae,Ae)};ne(Nt,ae=>{k(g).type==="eye_contact"?ae(Ai):ae(Ri,!1)})}var xt=Y(Nt,2),wi=V(xt,!0);H(xt),H(Pt),H(Z),tt(()=>{ke(Z,1,`animate-fade-in absolute bottom-32 left-1/2 z-30 -translate-x-1/2 rounded-2xl px-6 py-3 shadow-lg backdrop-blur-md transition-all duration-500
					${k(g).severity==="info"?"border border-blue-400/30 bg-blue-500/20 text-blue-100":""}
					${k(g).severity==="warning"?"border border-amber-400/30 bg-amber-500/20 text-amber-100":""}
					${k(g).severity==="success"?"border border-emerald-400/30 bg-emerald-500/20 text-emerald-100":""}`),Me(wi,k(g).message)}),q(L,Z)};ne(Ci,L=>{k(g)&&L(Si)})}H(D);var Ii=Y(D,2);ff(Ii,{get isConnected(){return k(o)},onEndSession:v,get micActive(){return k(s)},set micActive(L){Re(s,L,!0)}}),H(R),tt(()=>{ke(A,1,`h-2 w-2 rounded-full ${k(o)?"animate-pulse bg-red-500":"bg-slate-500"}`),Me(U,`Live Session  ${f??""}`),ke($,1,`mb-6 flex h-32 w-32 items-center justify-center rounded-full shadow-[0_0_60px_rgba(255,255,255,0.1)] transition-all duration-500 ${k(o)?"scale-100 border-2 border-indigo-400/50 bg-indigo-500/20":"scale-90 bg-slate-800"}`),Me(wt,`${d??""} `),Me(Ei,k(o)?"Listening & Analyzing...":"Connecting...")}),q(S,R)};ne(E,S=>{c&&S(I)})}q(t,C),So()}Io(["click"]);export{xf as component};
